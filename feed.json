{
    "version": "https://jsonfeed.org/version/1",
    "title": "It's a blog",
    "description": "",
    "home_page_url": "https://utgnim.github.io",
    "items": [
        {
            "id": "https://utgnim.github.io/%E6%B5%AE%E7%94%9F%E5%85%AD%E8%AE%B0-%E5%8D%B7%E4%B8%80-%E9%97%BA%E6%88%BF%E8%AE%B0%E4%B9%90-%E4%BA%8C%E5%8D%81%E5%9B%9B/",
            "url": "https://utgnim.github.io/%E6%B5%AE%E7%94%9F%E5%85%AD%E8%AE%B0-%E5%8D%B7%E4%B8%80-%E9%97%BA%E6%88%BF%E8%AE%B0%E4%B9%90-%E4%BA%8C%E5%8D%81%E5%9B%9B/",
            "title": "浮生六记-卷一-闺房记乐-二十四",
            "date_published": "2026-02-24T14:39:17.000Z",
            "content_html": "<p>命仆至船艄，与舟子同饮。</p>\n<p>船家女名素云，与余有杯酒交，人颇不俗，招之与芸同坐。船头不张灯火，待月快酌，射覆为令。素动双目闪闪，听良久，曰：“觞政侬颇娴习，从未闻有斯令，愿受教。”芸即譬其言而开导之，终茫然。</p>\n<p>余笑曰：“女先生且罢论，我有一言作譬，即了然矣。”</p>\n<p>芸曰：“鹤善舞而不能耕，牛善耕而不能舞，物性然也，先生欲反而教之，无乃劳乎？”</p>\n<p>素云笑捶余肩曰：“汝骂我耶！”</p>\n<p>芸出令曰：“只许动口，不许动手。违者罚大觥。”素云量豪，满斟一觥，一吸而尽。</p>\n<p>余曰：“动手但准摸索，不准捶人。”</p>\n<p>芸笑挽素云，置余怀，曰：“请君摸索畅怀。”</p>\n<p>余笑曰：“卿非解人，摸索在有意无意间耳。拥而狂探，田舍郎之所为也。”</p>\n<p>时四鬓所簪茉莉，为酒气所蒸，杂以粉汗油香，芳馨透鼻。余戏曰：“小人臭味充满船头，令人作恶。”素云不禁握拳连捶曰：“谁教汝狂嗅耶？”芸呼曰：“违令，罚两大觥！”素云曰：“彼又以小人骂我，不应捶耶？”</p>\n<p>芸曰：”彼之所谓小人，盖有故也。请干此，当告汝。”</p>\n<p>素云乃连尽两觥，芸乃告以沧浪旧居乘凉事。素云曰：“若然，真错怪矣，当再罚。”又干一觥。</p>\n<p>芸曰：“久闻素娘善歌，可一聆妙音否？”</p>\n<p>素即以象箸击小碟而歌。芸欣然畅饮，不觉酩酊，乃乘舆先归。余又与素云茶话片刻，步月而回。</p>\n<p>时余寄居友人鲁半舫家萧爽楼中。越数日，鲁夫人误有所闻，私告芸曰：“前日闻若婿挟两妓饮于万年桥舟中，子知之否？”</p>\n<p>芸曰：“有之，其一即我也。”因以偕游始末详告之。鲁大笑，释然而去。</p>\n",
            "tags": [
                "抄书",
                "练字"
            ]
        },
        {
            "id": "https://utgnim.github.io/%E6%B5%AE%E7%94%9F%E5%85%AD%E8%AE%B0-%E5%8D%B7%E4%B8%80-%E9%97%BA%E6%88%BF%E8%AE%B0%E4%B9%90-%E4%BA%8C%E5%8D%81%E4%B8%89/",
            "url": "https://utgnim.github.io/%E6%B5%AE%E7%94%9F%E5%85%AD%E8%AE%B0-%E5%8D%B7%E4%B8%80-%E9%97%BA%E6%88%BF%E8%AE%B0%E4%B9%90-%E4%BA%8C%E5%8D%81%E4%B8%89/",
            "title": "浮生六记-卷一-闺房记乐-二十三",
            "date_published": "2026-02-23T11:33:58.000Z",
            "content_html": "<p>吴江钱师竹病故，吾父信归，命余往吊。</p>\n<p>芸私谓余曰：“吴江必经太湖，妾欲偕往，一宽眼界。”余曰：“正虑独行踽踽，得卿同行，固妙，但无可托词耳。”芸曰：“托言归宁。君先登舟，妾当继至。”余曰：“若然，归途当泊舟万年桥下，与卿待月乘凉，以续沧浪韵事。”</p>\n<p>时六月十八日也。是日早凉，携一仆先至胥江渡口，登舟而待，芸果肩舆至。解维出虎啸桥，渐见风帆沙鸟，水天一色。</p>\n<p>芸曰：“此即所谓太湖耶？今得见天地之宽，不虚此生矣！想闺中人有终身不能见此者！”闲话未几，风摇岸柳，已抵江城。</p>\n<p>余登岸拜奠毕，归视舟中洞然，急询舟子。舟子指曰：“不见长桥柳阴下观鱼鹰捕鱼者乎？”盖芸已与船家女登岸矣。</p>\n<p>余至其后，芸犹粉汗盈盈，倚女而出神焉。余拍其肩曰：“罗衫汗透矣！”</p>\n<p>芸回首曰：“恐钱家有人到舟，故暂避之。君何回来之速也？”</p>\n<p>余笑曰：“欲逋逃耳。”</p>\n<p>于是相挽登舟，返棹至万年桥下，阳乌犹未落也。舟窗尽落，清风徐来，纨扇罗衫，剖瓜解暑。少焉，霞映桥红，烟笼柳暗，银蟾欲上，渔火满江矣。</p>\n",
            "tags": [
                "抄书",
                "练字"
            ]
        },
        {
            "id": "https://utgnim.github.io/%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/",
            "url": "https://utgnim.github.io/%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/",
            "title": "常用命令",
            "date_published": "2026-02-15T10:06:24.000Z",
            "content_html": "<h2 id=\"Git-配置终端识别名\"><a href=\"#Git-配置终端识别名\" class=\"headerlink\" title=\"Git 配置终端识别名\"></a>Git 配置终端识别名</h2><blockquote>\n<p>git config –global user.email “youremail”</p>\n<p>git config –global user.name “yourname”</p>\n</blockquote>\n<h2 id=\"Git-生成-SSH-KEY-并授权-GitHub-项目处理权限\"><a href=\"#Git-生成-SSH-KEY-并授权-GitHub-项目处理权限\" class=\"headerlink\" title=\"Git 生成 SSH KEY 并授权 GitHub 项目处理权限\"></a>Git 生成 SSH KEY 并授权 GitHub 项目处理权限</h2><blockquote>\n<p>ssh-keygen -t ed25519 -C “<a href=\"mailto:&#121;&#111;&#x75;&#114;&#110;&#97;&#x6d;&#x65;&#x40;&#x65;&#109;&#x61;&#105;&#x6c;&#x2e;&#x63;&#111;&#109;\">&#121;&#111;&#x75;&#114;&#110;&#97;&#x6d;&#x65;&#x40;&#x65;&#109;&#x61;&#105;&#x6c;&#x2e;&#x63;&#111;&#109;</a>“</p>\n<p>cat ~&#x2F;.ssh&#x2F;id_ed25519.pub</p>\n<p>将公钥填写到 GitHub 设置中</p>\n<p>ssh -T <a href=\"mailto:&#103;&#x69;&#116;&#64;&#x67;&#105;&#x74;&#x68;&#117;&#98;&#x2e;&#x63;&#111;&#x6d;\">&#103;&#x69;&#116;&#64;&#x67;&#105;&#x74;&#x68;&#117;&#98;&#x2e;&#x63;&#111;&#x6d;</a></p>\n<p>测试连接</p>\n</blockquote>\n<h2 id=\"Git-中显示中文而非转义序列\"><a href=\"#Git-中显示中文而非转义序列\" class=\"headerlink\" title=\"Git 中显示中文而非转义序列\"></a>Git 中显示中文而非转义序列</h2><blockquote>\n<p>git config –global core.quotepath false</p>\n</blockquote>\n<h2 id=\"Git-配置代理和取消代理\"><a href=\"#Git-配置代理和取消代理\" class=\"headerlink\" title=\"Git 配置代理和取消代理\"></a>Git 配置代理和取消代理</h2><blockquote>\n<p>git config –global http.proxy <a href=\"http://127.0.0.1:7890/\">http://127.0.0.1:7890</a></p>\n<p>git config –global https.proxy <a href=\"http://127.0.0.1:7890/\">http://127.0.0.1:7890</a></p>\n<p>git config –global –unset-all http.proxy</p>\n<p>git config –global –unset-all https.proxy</p>\n</blockquote>\n<h2 id=\"Git-添加仓库地址，替换仓库地址\"><a href=\"#Git-添加仓库地址，替换仓库地址\" class=\"headerlink\" title=\"Git 添加仓库地址，替换仓库地址\"></a>Git 添加仓库地址，替换仓库地址</h2><blockquote>\n<p>git remote add origin <a href=\"https://github.com/utgnim/____.git\">https://github.com/utgnim/____.git</a></p>\n<p>git remote set-url origin <a href=\"https://github.com/utgnim/_____.git\">https://github.com/utgnim/_____.git</a></p>\n</blockquote>\n<h2 id=\"Hexo-命令\"><a href=\"#Hexo-命令\" class=\"headerlink\" title=\"Hexo 命令\"></a>Hexo 命令</h2><blockquote>\n<p>hexo –config _config.yml g &amp; hexo –config _config_gal.yml g</p>\n</blockquote>\n",
            "tags": [
                "技术"
            ]
        },
        {
            "id": "https://utgnim.github.io/%E7%8E%B0%E8%B1%A1%E4%B8%83%E5%8D%81%E4%BA%8C%E5%8F%98/",
            "url": "https://utgnim.github.io/%E7%8E%B0%E8%B1%A1%E4%B8%83%E5%8D%81%E4%BA%8C%E5%8F%98/",
            "title": "现象七十二变",
            "date_published": "2026-02-13T13:52:07.000Z",
            "content_html": "<p>黄花岗有七十二个烈士<br>孔老夫子有七十二个弟子<br>孙悟空的魔法七十二变<br>我们又等到民国七十二年<br>岁岁年年风水都在改变<br>有多少沧海一夜变成桑田<br>在这个五千年的悠久历史里面<br>成功与失败多少都有一点<br>清清楚楚写在你的脸上<br>你是个道道地地的聪明人<br>慌慌张张迈开你的脚步<br>你是个匆匆忙忙的现代人<br>有人默默耕耘默默从事<br>有人在过着他的太平日子<br>有人在大白天里彼此明争暗斗<br>有人在黑夜之中枪杀歌手<br>随着都市现代化的程度<br>每个人多少追求一点幸福<br>是个什么样的心理因素<br>每年要吃掉一条高速公路<br>在西门町的天桥上面闲逛<br>有多少文明人在人行道上<br>就像我看到文明车辆横冲直撞<br>我不懂大家心中作何感想<br>一年过了又是新的一年<br>每一年现代都在传统边缘<br>在每个新的一年三百六十五天<br>我们都每天进步一点点<br>眼看着高楼盖得越来越高<br>我们的人情味却越来越薄<br>朋友之间越来越有礼貌<br>只因为大家见面越来越少<br>苹果价钱卖得没以前高<br>或许现在味道变得不好<br>就像彩色的电视变得更加花俏<br>能辨别黑白的人愈来愈少<br>一年过了又是一年<br>每一年都曾经是新的一年<br>在每个新的一年三百六十五天<br>我们都每天进步一点点<br>现实生活不能等待奇迹<br>这是个非常简单的道理<br>如果只要生存非常容易<br>只要你对人保持一点距离<br>但是生活不能像在演戏<br>你戴着面具如何面对自己<br>或许你将会真的发现一些奇迹<br>只要你抛开一些面子问题<br>或许你将会发现人生还算美丽<br>只要你抛开一些面子问题<br>🎼</p>\n",
            "tags": [
                "歌词"
            ]
        },
        {
            "id": "https://utgnim.github.io/NetIdleShutdown-%E6%97%A0%E7%BD%91%E7%BB%9C%E6%97%A0%E6%93%8D%E4%BD%9C%E8%87%AA%E5%8A%A8%E5%85%B3%E6%9C%BA%E5%B0%8F%E7%A8%8B%E5%BA%8F-C/",
            "url": "https://utgnim.github.io/NetIdleShutdown-%E6%97%A0%E7%BD%91%E7%BB%9C%E6%97%A0%E6%93%8D%E4%BD%9C%E8%87%AA%E5%8A%A8%E5%85%B3%E6%9C%BA%E5%B0%8F%E7%A8%8B%E5%BA%8F-C/",
            "title": "NetIdleShutdown 无网络无操作自动关机小程序[C#]",
            "date_published": "2026-02-13T10:16:11.000Z",
            "content_html": "<h2 id=\"背景\"><a href=\"#背景\" class=\"headerlink\" title=\"背景\"></a>背景</h2><p>远程操控位于家中的电脑时，偶尔会遇到路由器或光猫当机的情况，网络突然断开，电脑却还没关机，只能等待下次断电路由器或光猫重启才能重新连接上电脑，这就非常耗电，于是有了这个小工具！</p>\n<h2 id=\"过程\"><a href=\"#过程\" class=\"headerlink\" title=\"过程\"></a>过程</h2><p>由于本人十分的菜，尽管也曾憧憬过成为一个程序员，但一直三分热度、半途而废，到最后不了了之。所以你可以猜到代码并不是我写的。</p>\n<p>代码由 Gemini 提供思路，DeepSeek 写成，经历了大约三天的时间，期间不断的请 AI 修改、编译，手动测试，最后终于能够成功运行。经初步短期测试，应该没有什么大问题，故分享出来，代码<code>NetIdleShutdown.cs</code>如下：</p>\n<figure class=\"highlight csharp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br><span class=\"line\">241</span><br><span class=\"line\">242</span><br><span class=\"line\">243</span><br><span class=\"line\">244</span><br><span class=\"line\">245</span><br><span class=\"line\">246</span><br><span class=\"line\">247</span><br><span class=\"line\">248</span><br><span class=\"line\">249</span><br><span class=\"line\">250</span><br><span class=\"line\">251</span><br><span class=\"line\">252</span><br><span class=\"line\">253</span><br><span class=\"line\">254</span><br><span class=\"line\">255</span><br><span class=\"line\">256</span><br><span class=\"line\">257</span><br><span class=\"line\">258</span><br><span class=\"line\">259</span><br><span class=\"line\">260</span><br><span class=\"line\">261</span><br><span class=\"line\">262</span><br><span class=\"line\">263</span><br><span class=\"line\">264</span><br><span class=\"line\">265</span><br><span class=\"line\">266</span><br><span class=\"line\">267</span><br><span class=\"line\">268</span><br><span class=\"line\">269</span><br><span class=\"line\">270</span><br><span class=\"line\">271</span><br><span class=\"line\">272</span><br><span class=\"line\">273</span><br><span class=\"line\">274</span><br><span class=\"line\">275</span><br><span class=\"line\">276</span><br><span class=\"line\">277</span><br><span class=\"line\">278</span><br><span class=\"line\">279</span><br><span class=\"line\">280</span><br><span class=\"line\">281</span><br><span class=\"line\">282</span><br><span class=\"line\">283</span><br><span class=\"line\">284</span><br><span class=\"line\">285</span><br><span class=\"line\">286</span><br><span class=\"line\">287</span><br><span class=\"line\">288</span><br><span class=\"line\">289</span><br><span class=\"line\">290</span><br><span class=\"line\">291</span><br><span class=\"line\">292</span><br><span class=\"line\">293</span><br><span class=\"line\">294</span><br><span class=\"line\">295</span><br><span class=\"line\">296</span><br><span class=\"line\">297</span><br><span class=\"line\">298</span><br><span class=\"line\">299</span><br><span class=\"line\">300</span><br><span class=\"line\">301</span><br><span class=\"line\">302</span><br><span class=\"line\">303</span><br><span class=\"line\">304</span><br><span class=\"line\">305</span><br><span class=\"line\">306</span><br><span class=\"line\">307</span><br><span class=\"line\">308</span><br><span class=\"line\">309</span><br><span class=\"line\">310</span><br><span class=\"line\">311</span><br><span class=\"line\">312</span><br><span class=\"line\">313</span><br><span class=\"line\">314</span><br><span class=\"line\">315</span><br><span class=\"line\">316</span><br><span class=\"line\">317</span><br><span class=\"line\">318</span><br><span class=\"line\">319</span><br><span class=\"line\">320</span><br><span class=\"line\">321</span><br><span class=\"line\">322</span><br><span class=\"line\">323</span><br><span class=\"line\">324</span><br><span class=\"line\">325</span><br><span class=\"line\">326</span><br><span class=\"line\">327</span><br><span class=\"line\">328</span><br><span class=\"line\">329</span><br><span class=\"line\">330</span><br><span class=\"line\">331</span><br><span class=\"line\">332</span><br><span class=\"line\">333</span><br><span class=\"line\">334</span><br><span class=\"line\">335</span><br><span class=\"line\">336</span><br><span class=\"line\">337</span><br><span class=\"line\">338</span><br><span class=\"line\">339</span><br><span class=\"line\">340</span><br><span class=\"line\">341</span><br><span class=\"line\">342</span><br><span class=\"line\">343</span><br><span class=\"line\">344</span><br><span class=\"line\">345</span><br><span class=\"line\">346</span><br><span class=\"line\">347</span><br><span class=\"line\">348</span><br><span class=\"line\">349</span><br><span class=\"line\">350</span><br><span class=\"line\">351</span><br><span class=\"line\">352</span><br><span class=\"line\">353</span><br><span class=\"line\">354</span><br><span class=\"line\">355</span><br><span class=\"line\">356</span><br><span class=\"line\">357</span><br><span class=\"line\">358</span><br><span class=\"line\">359</span><br><span class=\"line\">360</span><br><span class=\"line\">361</span><br><span class=\"line\">362</span><br><span class=\"line\">363</span><br><span class=\"line\">364</span><br><span class=\"line\">365</span><br><span class=\"line\">366</span><br><span class=\"line\">367</span><br><span class=\"line\">368</span><br><span class=\"line\">369</span><br><span class=\"line\">370</span><br><span class=\"line\">371</span><br><span class=\"line\">372</span><br><span class=\"line\">373</span><br><span class=\"line\">374</span><br><span class=\"line\">375</span><br><span class=\"line\">376</span><br><span class=\"line\">377</span><br><span class=\"line\">378</span><br><span class=\"line\">379</span><br><span class=\"line\">380</span><br><span class=\"line\">381</span><br><span class=\"line\">382</span><br><span class=\"line\">383</span><br><span class=\"line\">384</span><br><span class=\"line\">385</span><br><span class=\"line\">386</span><br><span class=\"line\">387</span><br><span class=\"line\">388</span><br><span class=\"line\">389</span><br><span class=\"line\">390</span><br><span class=\"line\">391</span><br><span class=\"line\">392</span><br><span class=\"line\">393</span><br><span class=\"line\">394</span><br><span class=\"line\">395</span><br><span class=\"line\">396</span><br><span class=\"line\">397</span><br><span class=\"line\">398</span><br><span class=\"line\">399</span><br><span class=\"line\">400</span><br><span class=\"line\">401</span><br><span class=\"line\">402</span><br><span class=\"line\">403</span><br><span class=\"line\">404</span><br><span class=\"line\">405</span><br><span class=\"line\">406</span><br><span class=\"line\">407</span><br><span class=\"line\">408</span><br><span class=\"line\">409</span><br><span class=\"line\">410</span><br><span class=\"line\">411</span><br><span class=\"line\">412</span><br><span class=\"line\">413</span><br><span class=\"line\">414</span><br><span class=\"line\">415</span><br><span class=\"line\">416</span><br><span class=\"line\">417</span><br><span class=\"line\">418</span><br><span class=\"line\">419</span><br><span class=\"line\">420</span><br><span class=\"line\">421</span><br><span class=\"line\">422</span><br><span class=\"line\">423</span><br><span class=\"line\">424</span><br><span class=\"line\">425</span><br><span class=\"line\">426</span><br><span class=\"line\">427</span><br><span class=\"line\">428</span><br><span class=\"line\">429</span><br><span class=\"line\">430</span><br><span class=\"line\">431</span><br><span class=\"line\">432</span><br><span class=\"line\">433</span><br><span class=\"line\">434</span><br><span class=\"line\">435</span><br><span class=\"line\">436</span><br><span class=\"line\">437</span><br><span class=\"line\">438</span><br><span class=\"line\">439</span><br><span class=\"line\">440</span><br><span class=\"line\">441</span><br><span class=\"line\">442</span><br><span class=\"line\">443</span><br><span class=\"line\">444</span><br><span class=\"line\">445</span><br><span class=\"line\">446</span><br><span class=\"line\">447</span><br><span class=\"line\">448</span><br><span class=\"line\">449</span><br><span class=\"line\">450</span><br><span class=\"line\">451</span><br><span class=\"line\">452</span><br><span class=\"line\">453</span><br><span class=\"line\">454</span><br><span class=\"line\">455</span><br><span class=\"line\">456</span><br><span class=\"line\">457</span><br><span class=\"line\">458</span><br><span class=\"line\">459</span><br><span class=\"line\">460</span><br><span class=\"line\">461</span><br><span class=\"line\">462</span><br><span class=\"line\">463</span><br><span class=\"line\">464</span><br><span class=\"line\">465</span><br><span class=\"line\">466</span><br><span class=\"line\">467</span><br><span class=\"line\">468</span><br><span class=\"line\">469</span><br><span class=\"line\">470</span><br><span class=\"line\">471</span><br><span class=\"line\">472</span><br><span class=\"line\">473</span><br><span class=\"line\">474</span><br><span class=\"line\">475</span><br><span class=\"line\">476</span><br><span class=\"line\">477</span><br><span class=\"line\">478</span><br><span class=\"line\">479</span><br><span class=\"line\">480</span><br><span class=\"line\">481</span><br><span class=\"line\">482</span><br><span class=\"line\">483</span><br><span class=\"line\">484</span><br><span class=\"line\">485</span><br><span class=\"line\">486</span><br><span class=\"line\">487</span><br><span class=\"line\">488</span><br><span class=\"line\">489</span><br><span class=\"line\">490</span><br><span class=\"line\">491</span><br><span class=\"line\">492</span><br><span class=\"line\">493</span><br><span class=\"line\">494</span><br><span class=\"line\">495</span><br><span class=\"line\">496</span><br><span class=\"line\">497</span><br><span class=\"line\">498</span><br><span class=\"line\">499</span><br><span class=\"line\">500</span><br><span class=\"line\">501</span><br><span class=\"line\">502</span><br><span class=\"line\">503</span><br><span class=\"line\">504</span><br><span class=\"line\">505</span><br><span class=\"line\">506</span><br><span class=\"line\">507</span><br><span class=\"line\">508</span><br><span class=\"line\">509</span><br><span class=\"line\">510</span><br><span class=\"line\">511</span><br><span class=\"line\">512</span><br><span class=\"line\">513</span><br><span class=\"line\">514</span><br><span class=\"line\">515</span><br><span class=\"line\">516</span><br><span class=\"line\">517</span><br><span class=\"line\">518</span><br><span class=\"line\">519</span><br><span class=\"line\">520</span><br><span class=\"line\">521</span><br><span class=\"line\">522</span><br><span class=\"line\">523</span><br><span class=\"line\">524</span><br><span class=\"line\">525</span><br><span class=\"line\">526</span><br><span class=\"line\">527</span><br><span class=\"line\">528</span><br><span class=\"line\">529</span><br><span class=\"line\">530</span><br><span class=\"line\">531</span><br><span class=\"line\">532</span><br><span class=\"line\">533</span><br><span class=\"line\">534</span><br><span class=\"line\">535</span><br><span class=\"line\">536</span><br><span class=\"line\">537</span><br><span class=\"line\">538</span><br><span class=\"line\">539</span><br><span class=\"line\">540</span><br><span class=\"line\">541</span><br><span class=\"line\">542</span><br><span class=\"line\">543</span><br><span class=\"line\">544</span><br><span class=\"line\">545</span><br><span class=\"line\">546</span><br><span class=\"line\">547</span><br><span class=\"line\">548</span><br><span class=\"line\">549</span><br><span class=\"line\">550</span><br><span class=\"line\">551</span><br><span class=\"line\">552</span><br><span class=\"line\">553</span><br><span class=\"line\">554</span><br><span class=\"line\">555</span><br><span class=\"line\">556</span><br><span class=\"line\">557</span><br><span class=\"line\">558</span><br><span class=\"line\">559</span><br><span class=\"line\">560</span><br><span class=\"line\">561</span><br><span class=\"line\">562</span><br><span class=\"line\">563</span><br><span class=\"line\">564</span><br><span class=\"line\">565</span><br><span class=\"line\">566</span><br><span class=\"line\">567</span><br><span class=\"line\">568</span><br><span class=\"line\">569</span><br><span class=\"line\">570</span><br><span class=\"line\">571</span><br><span class=\"line\">572</span><br><span class=\"line\">573</span><br><span class=\"line\">574</span><br><span class=\"line\">575</span><br><span class=\"line\">576</span><br><span class=\"line\">577</span><br><span class=\"line\">578</span><br><span class=\"line\">579</span><br><span class=\"line\">580</span><br><span class=\"line\">581</span><br><span class=\"line\">582</span><br><span class=\"line\">583</span><br><span class=\"line\">584</span><br><span class=\"line\">585</span><br><span class=\"line\">586</span><br><span class=\"line\">587</span><br><span class=\"line\">588</span><br><span class=\"line\">589</span><br><span class=\"line\">590</span><br><span class=\"line\">591</span><br><span class=\"line\">592</span><br><span class=\"line\">593</span><br><span class=\"line\">594</span><br><span class=\"line\">595</span><br><span class=\"line\">596</span><br><span class=\"line\">597</span><br><span class=\"line\">598</span><br><span class=\"line\">599</span><br><span class=\"line\">600</span><br><span class=\"line\">601</span><br><span class=\"line\">602</span><br><span class=\"line\">603</span><br><span class=\"line\">604</span><br><span class=\"line\">605</span><br><span class=\"line\">606</span><br><span class=\"line\">607</span><br><span class=\"line\">608</span><br><span class=\"line\">609</span><br><span class=\"line\">610</span><br><span class=\"line\">611</span><br><span class=\"line\">612</span><br><span class=\"line\">613</span><br><span class=\"line\">614</span><br><span class=\"line\">615</span><br><span class=\"line\">616</span><br><span class=\"line\">617</span><br><span class=\"line\">618</span><br><span class=\"line\">619</span><br><span class=\"line\">620</span><br><span class=\"line\">621</span><br><span class=\"line\">622</span><br><span class=\"line\">623</span><br><span class=\"line\">624</span><br><span class=\"line\">625</span><br><span class=\"line\">626</span><br><span class=\"line\">627</span><br><span class=\"line\">628</span><br><span class=\"line\">629</span><br><span class=\"line\">630</span><br><span class=\"line\">631</span><br><span class=\"line\">632</span><br><span class=\"line\">633</span><br><span class=\"line\">634</span><br><span class=\"line\">635</span><br><span class=\"line\">636</span><br><span class=\"line\">637</span><br><span class=\"line\">638</span><br><span class=\"line\">639</span><br><span class=\"line\">640</span><br><span class=\"line\">641</span><br><span class=\"line\">642</span><br><span class=\"line\">643</span><br><span class=\"line\">644</span><br><span class=\"line\">645</span><br><span class=\"line\">646</span><br><span class=\"line\">647</span><br><span class=\"line\">648</span><br><span class=\"line\">649</span><br><span class=\"line\">650</span><br><span class=\"line\">651</span><br><span class=\"line\">652</span><br><span class=\"line\">653</span><br><span class=\"line\">654</span><br><span class=\"line\">655</span><br><span class=\"line\">656</span><br><span class=\"line\">657</span><br><span class=\"line\">658</span><br><span class=\"line\">659</span><br><span class=\"line\">660</span><br><span class=\"line\">661</span><br><span class=\"line\">662</span><br><span class=\"line\">663</span><br><span class=\"line\">664</span><br><span class=\"line\">665</span><br><span class=\"line\">666</span><br><span class=\"line\">667</span><br><span class=\"line\">668</span><br><span class=\"line\">669</span><br><span class=\"line\">670</span><br><span class=\"line\">671</span><br><span class=\"line\">672</span><br><span class=\"line\">673</span><br><span class=\"line\">674</span><br><span class=\"line\">675</span><br><span class=\"line\">676</span><br><span class=\"line\">677</span><br><span class=\"line\">678</span><br><span class=\"line\">679</span><br><span class=\"line\">680</span><br><span class=\"line\">681</span><br><span class=\"line\">682</span><br><span class=\"line\">683</span><br><span class=\"line\">684</span><br><span class=\"line\">685</span><br><span class=\"line\">686</span><br><span class=\"line\">687</span><br><span class=\"line\">688</span><br><span class=\"line\">689</span><br><span class=\"line\">690</span><br><span class=\"line\">691</span><br><span class=\"line\">692</span><br><span class=\"line\">693</span><br><span class=\"line\">694</span><br><span class=\"line\">695</span><br><span class=\"line\">696</span><br><span class=\"line\">697</span><br><span class=\"line\">698</span><br><span class=\"line\">699</span><br><span class=\"line\">700</span><br><span class=\"line\">701</span><br><span class=\"line\">702</span><br><span class=\"line\">703</span><br><span class=\"line\">704</span><br><span class=\"line\">705</span><br><span class=\"line\">706</span><br><span class=\"line\">707</span><br><span class=\"line\">708</span><br><span class=\"line\">709</span><br><span class=\"line\">710</span><br><span class=\"line\">711</span><br><span class=\"line\">712</span><br><span class=\"line\">713</span><br><span class=\"line\">714</span><br><span class=\"line\">715</span><br><span class=\"line\">716</span><br><span class=\"line\">717</span><br><span class=\"line\">718</span><br><span class=\"line\">719</span><br><span class=\"line\">720</span><br><span class=\"line\">721</span><br><span class=\"line\">722</span><br><span class=\"line\">723</span><br><span class=\"line\">724</span><br><span class=\"line\">725</span><br><span class=\"line\">726</span><br><span class=\"line\">727</span><br><span class=\"line\">728</span><br><span class=\"line\">729</span><br><span class=\"line\">730</span><br><span class=\"line\">731</span><br><span class=\"line\">732</span><br><span class=\"line\">733</span><br><span class=\"line\">734</span><br><span class=\"line\">735</span><br><span class=\"line\">736</span><br><span class=\"line\">737</span><br><span class=\"line\">738</span><br><span class=\"line\">739</span><br><span class=\"line\">740</span><br><span class=\"line\">741</span><br><span class=\"line\">742</span><br><span class=\"line\">743</span><br><span class=\"line\">744</span><br><span class=\"line\">745</span><br><span class=\"line\">746</span><br><span class=\"line\">747</span><br><span class=\"line\">748</span><br><span class=\"line\">749</span><br><span class=\"line\">750</span><br><span class=\"line\">751</span><br><span class=\"line\">752</span><br><span class=\"line\">753</span><br><span class=\"line\">754</span><br><span class=\"line\">755</span><br><span class=\"line\">756</span><br><span class=\"line\">757</span><br><span class=\"line\">758</span><br><span class=\"line\">759</span><br><span class=\"line\">760</span><br><span class=\"line\">761</span><br><span class=\"line\">762</span><br><span class=\"line\">763</span><br><span class=\"line\">764</span><br><span class=\"line\">765</span><br><span class=\"line\">766</span><br><span class=\"line\">767</span><br><span class=\"line\">768</span><br><span class=\"line\">769</span><br><span class=\"line\">770</span><br><span class=\"line\">771</span><br><span class=\"line\">772</span><br><span class=\"line\">773</span><br><span class=\"line\">774</span><br><span class=\"line\">775</span><br><span class=\"line\">776</span><br><span class=\"line\">777</span><br><span class=\"line\">778</span><br><span class=\"line\">779</span><br><span class=\"line\">780</span><br><span class=\"line\">781</span><br><span class=\"line\">782</span><br><span class=\"line\">783</span><br><span class=\"line\">784</span><br><span class=\"line\">785</span><br><span class=\"line\">786</span><br><span class=\"line\">787</span><br><span class=\"line\">788</span><br><span class=\"line\">789</span><br><span class=\"line\">790</span><br><span class=\"line\">791</span><br><span class=\"line\">792</span><br><span class=\"line\">793</span><br><span class=\"line\">794</span><br><span class=\"line\">795</span><br><span class=\"line\">796</span><br><span class=\"line\">797</span><br><span class=\"line\">798</span><br><span class=\"line\">799</span><br><span class=\"line\">800</span><br><span class=\"line\">801</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">using</span> System;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Diagnostics;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Net.NetworkInformation;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Threading;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Runtime.InteropServices;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Collections.Concurrent;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Collections.Generic;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Text;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Net;</span><br><span class=\"line\"><span class=\"keyword\">using</span> System.Linq;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">namespace</span> <span class=\"title\">NetIdleShutdown</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> 网络空闲关机程序</span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> 主要功能：</span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> 1. 检测网络连接状态（双重检测：Ping + HTTP）</span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> 2. 检测用户活动状态</span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> 3. 当网络断开且用户无操作时，自动执行关机操作</span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> 检测逻辑：</span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> - 使用并行线程同时检测多个目标，提高检测速度</span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> - 如果所有Ping目标都失败，则直接判断为网络离线</span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> - 如果有至少一个Ping成功，则继续进行HTTP检测</span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> - 必须同时满足Ping和HTTP检测都至少有一个成功，才判断为在线</span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> 配置说明：</span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> - 程序默认配置在AppConfig类中</span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> - 可修改默认值或通过构造函数传入自定义配置</span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">NetIdleShutdown</span> : <span class=\"title\">IDisposable</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"meta\">#<span class=\"keyword\">region</span> 配置类</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 应用程序配置类</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 包含所有可配置的参数和检测目标列表</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"keyword\">public</span> <span class=\"keyword\">class</span> <span class=\"title\">AppConfig</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 核心配置参数</span></span><br><span class=\"line\">            <span class=\"keyword\">public</span> <span class=\"built_in\">int</span> MaxNoNetMinutes = <span class=\"number\">3</span>;           <span class=\"comment\">// 无网络多少分钟后关机</span></span><br><span class=\"line\">            <span class=\"keyword\">public</span> <span class=\"built_in\">int</span> PingTimeoutMs = <span class=\"number\">1500</span>;          <span class=\"comment\">// Ping超时时间（毫秒）- 控制线程等待时间</span></span><br><span class=\"line\">            <span class=\"keyword\">public</span> <span class=\"built_in\">int</span> HttpTimeoutMs = <span class=\"number\">5000</span>;          <span class=\"comment\">// HTTP请求超时时间（毫秒）- 控制线程等待时间</span></span><br><span class=\"line\">            <span class=\"keyword\">public</span> <span class=\"built_in\">int</span> CheckIntervalSeconds = <span class=\"number\">60</span>;     <span class=\"comment\">// 检测间隔时间（秒）- 主循环等待时间</span></span><br><span class=\"line\">            <span class=\"keyword\">public</span> <span class=\"built_in\">int</span> UserIdleThresholdSeconds = <span class=\"number\">60</span>; <span class=\"comment\">// 用户空闲时间阈值（秒）- 判定用户无活动的阈值</span></span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"comment\">// 检测目标列表</span></span><br><span class=\"line\">            <span class=\"keyword\">public</span> List&lt;<span class=\"built_in\">string</span>&gt; PingTargets;  <span class=\"comment\">// Ping检测目标IP地址列表</span></span><br><span class=\"line\">            <span class=\"keyword\">public</span> List&lt;<span class=\"built_in\">string</span>&gt; HttpTargets;  <span class=\"comment\">// HTTP检测目标URL列表</span></span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">            <span class=\"comment\"><span class=\"doctag\">///</span> 构造函数，初始化默认配置和检测目标</span></span><br><span class=\"line\">            <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">            <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">AppConfig</span>()</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"comment\">// 初始化Ping检测目标列表</span></span><br><span class=\"line\">                <span class=\"comment\">// 包含国内外常用的公共DNS服务器，提高检测可靠性</span></span><br><span class=\"line\">                PingTargets = <span class=\"keyword\">new</span> List&lt;<span class=\"built_in\">string</span>&gt;</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"string\">&quot;223.5.5.5&quot;</span>,        <span class=\"comment\">// 阿里DNS - 国内常用</span></span><br><span class=\"line\">                    <span class=\"string\">&quot;119.29.29.29&quot;</span>,     <span class=\"comment\">// 腾讯DNS - 国内常用</span></span><br><span class=\"line\">                    <span class=\"string\">&quot;180.76.76.76&quot;</span>,     <span class=\"comment\">// 百度DNS - 国内常用</span></span><br><span class=\"line\">                    <span class=\"string\">&quot;1.1.1.1&quot;</span>,          <span class=\"comment\">// Cloudflare DNS - 国际常用</span></span><br><span class=\"line\">                    <span class=\"string\">&quot;8.8.8.8&quot;</span>,          <span class=\"comment\">// Google DNS - 国际常用</span></span><br><span class=\"line\">                    <span class=\"string\">&quot;114.114.114.114&quot;</span>,  <span class=\"comment\">// 114DNS - 国内常用</span></span><br><span class=\"line\">                    <span class=\"string\">&quot;208.67.222.222&quot;</span>,   <span class=\"comment\">// OpenDNS - 国际备用</span></span><br><span class=\"line\">                    <span class=\"string\">&quot;9.9.9.9&quot;</span>           <span class=\"comment\">// Quad9 DNS - 国际备用</span></span><br><span class=\"line\">                &#125;;</span><br><span class=\"line\">                </span><br><span class=\"line\">                <span class=\"comment\">// 初始化HTTP检测目标列表</span></span><br><span class=\"line\">                <span class=\"comment\">// 使用各大公司的网络连通性检测服务，通常返回204状态码</span></span><br><span class=\"line\">                HttpTargets = <span class=\"keyword\">new</span> List&lt;<span class=\"built_in\">string</span>&gt;</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"string\">&quot;http://connect.rom.miui.com/generate_204&quot;</span>,          <span class=\"comment\">// 小米网络检测服务</span></span><br><span class=\"line\">                    <span class=\"string\">&quot;http://connectivitycheck.gstatic.com/generate_204&quot;</span>, <span class=\"comment\">// Google网络检测服务</span></span><br><span class=\"line\">                    <span class=\"string\">&quot;http://www.gstatic.com/generate_204&quot;</span>,               <span class=\"comment\">// Google备用检测服务</span></span><br><span class=\"line\">                    <span class=\"string\">&quot;http://www.msftncsi.com/ncsi.txt&quot;</span>,                  <span class=\"comment\">// Microsoft网络检测服务</span></span><br><span class=\"line\">                    <span class=\"string\">&quot;http://captive.apple.com/hotspot-detect.html&quot;</span>,      <span class=\"comment\">// Apple网络检测服务</span></span><br><span class=\"line\">                    <span class=\"string\">&quot;http://connectivitycheck.platform.hicloud.com/generate_204&quot;</span> <span class=\"comment\">// 华为网络检测服务</span></span><br><span class=\"line\">                &#125;;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"meta\">#<span class=\"keyword\">endregion</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"meta\">#<span class=\"keyword\">region</span> Windows API声明</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 获取系统最后输入时间的Windows API函数</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 用于检测用户活动状态</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=&quot;plii&quot;&gt;</span>LASTINPUTINFO结构体引用<span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span>获取成功返回true，失败返回false<span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">        [<span class=\"meta\">DllImport(<span class=\"string\">&quot;user32.dll&quot;</span>)</span>]</span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">extern</span> <span class=\"built_in\">bool</span> <span class=\"title\">GetLastInputInfo</span>(<span class=\"params\"><span class=\"keyword\">ref</span> LASTINPUTINFO plii</span>)</span>;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 最后输入信息结构体</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 用于存储用户最后输入的时间信息</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">        [<span class=\"meta\">StructLayout(LayoutKind.Sequential)</span>]</span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">struct</span> LASTINPUTINFO</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">public</span> <span class=\"built_in\">uint</span> cbSize;    <span class=\"comment\">// 结构体大小</span></span><br><span class=\"line\">            <span class=\"keyword\">public</span> <span class=\"built_in\">uint</span> dwTime;    <span class=\"comment\">// 最后输入时间（系统启动后的毫秒数）</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"meta\">#<span class=\"keyword\">endregion</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"meta\">#<span class=\"keyword\">region</span> 私有字段</span></span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">readonly</span> AppConfig _config;                <span class=\"comment\">// 程序配置实例</span></span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"built_in\">int</span> _noNetCounter = <span class=\"number\">0</span>;                     <span class=\"comment\">// 无网络计数器</span></span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"built_in\">bool</span> _isRunning = <span class=\"literal\">true</span>;                    <span class=\"comment\">// 程序运行标志</span></span><br><span class=\"line\">        <span class=\"keyword\">private</span> <span class=\"keyword\">readonly</span> <span class=\"built_in\">object</span> _counterLock = <span class=\"keyword\">new</span> <span class=\"built_in\">object</span>(); <span class=\"comment\">// 计数器同步锁</span></span><br><span class=\"line\">        <span class=\"meta\">#<span class=\"keyword\">endregion</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"meta\">#<span class=\"keyword\">region</span> 构造函数</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 构造函数</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=&quot;config&quot;&gt;</span>自定义配置，如果为null则使用默认配置<span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">NetIdleShutdown</span>(<span class=\"params\">AppConfig config = <span class=\"literal\">null</span></span>)</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 使用传入的配置或创建默认配置</span></span><br><span class=\"line\">            _config = config ?? <span class=\"keyword\">new</span> AppConfig();</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"comment\">// 记录配置信息</span></span><br><span class=\"line\">            Console.WriteLine(<span class=\"string\">&quot;[SYSTEM] 程序配置已加载&quot;</span>);</span><br><span class=\"line\">            Console.WriteLine(<span class=\"string\">&quot;[SYSTEM] 无网络关机阈值: &quot;</span> + _config.MaxNoNetMinutes + <span class=\"string\">&quot; 分钟&quot;</span>);</span><br><span class=\"line\">            Console.WriteLine(<span class=\"string\">&quot;[SYSTEM] 检测间隔: &quot;</span> + _config.CheckIntervalSeconds + <span class=\"string\">&quot; 秒&quot;</span>);</span><br><span class=\"line\">            Console.WriteLine(<span class=\"string\">&quot;[SYSTEM] 用户空闲阈值: &quot;</span> + _config.UserIdleThresholdSeconds + <span class=\"string\">&quot; 秒&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"meta\">#<span class=\"keyword\">endregion</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"meta\">#<span class=\"keyword\">region</span> 主程序入口</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 启动网络守护程序主循环</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Run</span>()</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"comment\">// 显示程序标题和配置信息</span></span><br><span class=\"line\">                PrintBanner();</span><br><span class=\"line\">                </span><br><span class=\"line\">                <span class=\"comment\">// 主循环：持续检测网络和用户状态</span></span><br><span class=\"line\">                <span class=\"keyword\">while</span> (_isRunning)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// 执行一次完整的检测周期</span></span><br><span class=\"line\">                    PerformCheckCycle();</span><br><span class=\"line\">                    </span><br><span class=\"line\">                    <span class=\"comment\">// 等待指定的间隔时间，每秒检查一次是否停止</span></span><br><span class=\"line\">                    <span class=\"keyword\">for</span> (<span class=\"built_in\">int</span> i = <span class=\"number\">0</span>; i &lt; _config.CheckIntervalSeconds &amp;&amp; _isRunning; i++)</span><br><span class=\"line\">                    &#123;</span><br><span class=\"line\">                        Thread.Sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">catch</span> (Exception ex)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"comment\">// 记录严重错误并重新抛出</span></span><br><span class=\"line\">                LogError(<span class=\"string\">&quot;程序运行异常&quot;</span>, ex);</span><br><span class=\"line\">                <span class=\"keyword\">throw</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 停止守护程序</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 设置运行标志为false，使主循环退出</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Stop</span>()</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            _isRunning = <span class=\"literal\">false</span>;</span><br><span class=\"line\">            LogInfo(<span class=\"string\">&quot;程序已收到停止指令&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"meta\">#<span class=\"keyword\">endregion</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"meta\">#<span class=\"keyword\">region</span> 检测周期</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 执行一个完整的检测周期</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 包括网络检测、用户活动检测和状态处理</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">PerformCheckCycle</span>()</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> timestamp = DateTime.Now;</span><br><span class=\"line\">            LogInfo(<span class=\"string\">&quot;开始第 &quot;</span> + (_noNetCounter + <span class=\"number\">1</span>) + <span class=\"string\">&quot; 次检测&quot;</span>);</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"comment\">// 检测网络连接状态</span></span><br><span class=\"line\">            <span class=\"built_in\">bool</span> isOnline = CheckConnectivity();</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"comment\">// 根据网络状态进行相应处理</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (isOnline)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                HandleOnlineStatus(timestamp);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">else</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                HandleOfflineStatus(timestamp);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 处理在线状态</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 网络正常时重置计数器并记录状态</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=&quot;timestamp&quot;&gt;</span>检测时间戳<span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">HandleOnlineStatus</span>(<span class=\"params\">DateTime timestamp</span>)</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">lock</span> (_counterLock)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"comment\">// 如果之前有离线记录，则重置计数器</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (_noNetCounter &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    LogInfo(<span class=\"string\">&quot;网络恢复正常，无网络计数器已重置&quot;</span>);</span><br><span class=\"line\">                    _noNetCounter = <span class=\"number\">0</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            LogInfo(<span class=\"string\">&quot;网络状态: 在线&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 处理离线状态</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 网络断开时检查用户活动并更新计数器</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=&quot;timestamp&quot;&gt;</span>检测时间戳<span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">HandleOfflineStatus</span>(<span class=\"params\">DateTime timestamp</span>)</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 检测用户是否有输入活动</span></span><br><span class=\"line\">            <span class=\"built_in\">bool</span> hasUserActivity = HasUserInputActivity();</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"keyword\">if</span> (hasUserActivity)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"comment\">// 有用户活动，重置计数器</span></span><br><span class=\"line\">                <span class=\"keyword\">lock</span> (_counterLock)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (_noNetCounter &gt; <span class=\"number\">0</span>)</span><br><span class=\"line\">                    &#123;</span><br><span class=\"line\">                        LogInfo(<span class=\"string\">&quot;检测到用户活动，无网络计数器已重置&quot;</span>);</span><br><span class=\"line\">                        _noNetCounter = <span class=\"number\">0</span>;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                LogInfo(<span class=\"string\">&quot;网络状态: 离线 (用户活动中，不计数)&quot;</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">else</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"comment\">// 无用户活动，增加计数器</span></span><br><span class=\"line\">                <span class=\"keyword\">lock</span> (_counterLock)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    _noNetCounter++;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                </span><br><span class=\"line\">                LogInfo(<span class=\"string\">&quot;网络状态: 离线&quot;</span>);</span><br><span class=\"line\">                LogInfo(<span class=\"string\">&quot;无网络计数器: &quot;</span> + _noNetCounter + <span class=\"string\">&quot;/&quot;</span> + _config.MaxNoNetMinutes);</span><br><span class=\"line\">                </span><br><span class=\"line\">                <span class=\"comment\">// 检查是否达到关机条件</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (_noNetCounter &gt;= _config.MaxNoNetMinutes)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    ExecuteShutdown();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"meta\">#<span class=\"keyword\">endregion</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"meta\">#<span class=\"keyword\">region</span> 网络检测</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 检测网络连接状态</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 检测逻辑：</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 1. 并行执行Ping检测</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 2. 如果所有Ping目标都失败，直接判断为离线</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 3. 如果至少有一个Ping成功，则继续进行HTTP检测</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 4. 必须同时满足Ping和HTTP检测都至少有一个成功，才判断为在线</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 优化：网络完全断开时，最快800ms即可判断为离线</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span>true表示网络在线，false表示网络离线<span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"built_in\">bool</span> <span class=\"title\">CheckConnectivity</span>()</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            LogInfo(<span class=\"string\">&quot;开始网络连通性检测&quot;</span>);</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"comment\">// 第一步：并行执行Ping检测</span></span><br><span class=\"line\">            <span class=\"built_in\">bool</span> pingSuccess = PerformPingTestsParallel();</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"comment\">// 第二步：如果Ping检测全部失败，直接判断为离线</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!pingSuccess)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                LogInfo(<span class=\"string\">&quot;Ping检测结果: 全部失败，直接判定为网络离线&quot;</span>);</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"comment\">// 第三步：Ping检测通过，继续进行HTTP检测</span></span><br><span class=\"line\">            LogInfo(<span class=\"string\">&quot;Ping检测结果: 至少有一个成功，开始HTTP检测&quot;</span>);</span><br><span class=\"line\">            <span class=\"built_in\">bool</span> httpSuccess = PerformHttpTestsParallel();</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"comment\">// 第四步：必须同时满足Ping和HTTP检测都成功</span></span><br><span class=\"line\">            <span class=\"built_in\">bool</span> finalResult = pingSuccess &amp;&amp; httpSuccess;</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"comment\">// 记录详细检测结果</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (finalResult)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                LogInfo(<span class=\"string\">&quot;网络检测最终结果: 在线 (Ping和HTTP检测均通过)&quot;</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">else</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                LogInfo(<span class=\"string\">&quot;网络检测最终结果: 离线 (Ping: &quot;</span> + (pingSuccess ? <span class=\"string\">&quot;成功&quot;</span> : <span class=\"string\">&quot;失败&quot;</span>) + </span><br><span class=\"line\">                       <span class=\"string\">&quot;, HTTP: &quot;</span> + (httpSuccess ? <span class=\"string\">&quot;成功&quot;</span> : <span class=\"string\">&quot;失败&quot;</span>) + <span class=\"string\">&quot;)&quot;</span>);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"keyword\">return</span> finalResult;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 并行执行Ping测试</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 实现方式：</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 1. 为每个Ping目标创建一个独立线程</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 2. 所有线程同时执行，提高检测速度</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 3. 使用ConcurrentDictionary存储线程安全的结果</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 4. 使用Interlocked.Increment保证计数器的线程安全</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 超时控制：</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 每个线程最多等待PingTimeoutMs毫秒</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 超时线程将被强制终止</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span>true表示至少有一个Ping成功，false表示全部失败<span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"built_in\">bool</span> <span class=\"title\">PerformPingTestsParallel</span>()</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            LogInfo(<span class=\"string\">&quot;开始并行Ping测试 (目标数: &quot;</span> + _config.PingTargets.Count + <span class=\"string\">&quot;)&quot;</span>);</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"built_in\">int</span> successCount = <span class=\"number\">0</span>;  <span class=\"comment\">// 成功计数器</span></span><br><span class=\"line\">            <span class=\"keyword\">var</span> results = <span class=\"keyword\">new</span> ConcurrentDictionary&lt;<span class=\"built_in\">string</span>, <span class=\"built_in\">bool</span>&gt;();  <span class=\"comment\">// 结果存储</span></span><br><span class=\"line\">            <span class=\"keyword\">var</span> tasks = <span class=\"keyword\">new</span> List&lt;Thread&gt;();  <span class=\"comment\">// 线程列表</span></span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"comment\">// 为每个Ping目标创建线程</span></span><br><span class=\"line\">            <span class=\"keyword\">foreach</span> (<span class=\"keyword\">var</span> target <span class=\"keyword\">in</span> _config.PingTargets)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">var</span> thread = <span class=\"keyword\">new</span> Thread(() =&gt;</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"built_in\">bool</span> result = PingHostFast(target);</span><br><span class=\"line\">                    results[target] = result;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (result)</span><br><span class=\"line\">                    &#123;</span><br><span class=\"line\">                        Interlocked.Increment(<span class=\"keyword\">ref</span> successCount);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;);</span><br><span class=\"line\">                </span><br><span class=\"line\">                thread.Start();</span><br><span class=\"line\">                tasks.Add(thread);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"comment\">// 等待所有线程完成，最多等待PingTimeoutMs毫秒</span></span><br><span class=\"line\">            <span class=\"keyword\">foreach</span> (<span class=\"keyword\">var</span> thread <span class=\"keyword\">in</span> tasks)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (!thread.Join(_config.PingTimeoutMs))</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// 线程超时，强制终止</span></span><br><span class=\"line\">                    thread.Abort();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"comment\">// 输出Ping测试详细结果</span></span><br><span class=\"line\">            <span class=\"keyword\">var</span> resultBuilder = <span class=\"keyword\">new</span> StringBuilder();</span><br><span class=\"line\">            resultBuilder.AppendLine(<span class=\"string\">&quot;PING检测详细结果:&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">foreach</span> (<span class=\"keyword\">var</span> target <span class=\"keyword\">in</span> _config.PingTargets)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"built_in\">bool</span> result;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (results.TryGetValue(target, <span class=\"keyword\">out</span> result))</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"built_in\">string</span> status = result ? <span class=\"string\">&quot;成功&quot;</span> : <span class=\"string\">&quot;失败&quot;</span>;</span><br><span class=\"line\">                    resultBuilder.AppendLine(<span class=\"string\">&quot;  &quot;</span> + target.PadRight(<span class=\"number\">15</span>) + <span class=\"string\">&quot; =&gt; &quot;</span> + status);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">else</span></span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    resultBuilder.AppendLine(<span class=\"string\">&quot;  &quot;</span> + target.PadRight(<span class=\"number\">15</span>) + <span class=\"string\">&quot; =&gt; 超时&quot;</span>);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            </span><br><span class=\"line\">            LogInfo(resultBuilder.ToString());</span><br><span class=\"line\">            LogInfo(<span class=\"string\">&quot;PING检测统计: 成功 &quot;</span> + successCount + <span class=\"string\">&quot;/&quot;</span> + _config.PingTargets.Count);</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"keyword\">return</span> successCount &gt; <span class=\"number\">0</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 并行执行HTTP测试</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 检测原理：</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 使用HTTP HEAD方法请求网络连通性检测服务</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 这些服务通常返回204状态码或2xx状态码</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 只要返回2xx状态码就认为成功</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span>true表示至少有一个HTTP请求成功，false表示全部失败<span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"built_in\">bool</span> <span class=\"title\">PerformHttpTestsParallel</span>()</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            LogInfo(<span class=\"string\">&quot;开始并行HTTP测试 (目标数: &quot;</span> + _config.HttpTargets.Count + <span class=\"string\">&quot;)&quot;</span>);</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"built_in\">int</span> successCount = <span class=\"number\">0</span>;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> results = <span class=\"keyword\">new</span> ConcurrentDictionary&lt;<span class=\"built_in\">string</span>, <span class=\"built_in\">bool</span>&gt;();</span><br><span class=\"line\">            <span class=\"keyword\">var</span> tasks = <span class=\"keyword\">new</span> List&lt;Thread&gt;();</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"comment\">// 为每个HTTP目标创建线程</span></span><br><span class=\"line\">            <span class=\"keyword\">foreach</span> (<span class=\"keyword\">var</span> url <span class=\"keyword\">in</span> _config.HttpTargets)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">var</span> thread = <span class=\"keyword\">new</span> Thread(() =&gt;</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"built_in\">bool</span> result = TestHttpConnectionFast(url);</span><br><span class=\"line\">                    results[url] = result;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (result)</span><br><span class=\"line\">                    &#123;</span><br><span class=\"line\">                        Interlocked.Increment(<span class=\"keyword\">ref</span> successCount);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;);</span><br><span class=\"line\">                </span><br><span class=\"line\">                thread.Start();</span><br><span class=\"line\">                tasks.Add(thread);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"comment\">// 等待所有线程完成，最多等待HttpTimeoutMs毫秒</span></span><br><span class=\"line\">            <span class=\"keyword\">foreach</span> (<span class=\"keyword\">var</span> thread <span class=\"keyword\">in</span> tasks)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (!thread.Join(_config.HttpTimeoutMs))</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// 线程超时，强制终止</span></span><br><span class=\"line\">                    thread.Abort();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"comment\">// 输出HTTP测试详细结果</span></span><br><span class=\"line\">            <span class=\"keyword\">var</span> resultBuilder = <span class=\"keyword\">new</span> StringBuilder();</span><br><span class=\"line\">            resultBuilder.AppendLine(<span class=\"string\">&quot;HTTP检测详细结果:&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">foreach</span> (<span class=\"keyword\">var</span> url <span class=\"keyword\">in</span> _config.HttpTargets)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"built_in\">bool</span> result;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (results.TryGetValue(url, <span class=\"keyword\">out</span> result))</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"built_in\">string</span> status = result ? <span class=\"string\">&quot;成功&quot;</span> : <span class=\"string\">&quot;失败&quot;</span>;</span><br><span class=\"line\">                    resultBuilder.AppendLine(<span class=\"string\">&quot;  &quot;</span> + url + <span class=\"string\">&quot; =&gt; &quot;</span> + status);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">else</span></span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    resultBuilder.AppendLine(<span class=\"string\">&quot;  &quot;</span> + url + <span class=\"string\">&quot; =&gt; 超时&quot;</span>);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            </span><br><span class=\"line\">            LogInfo(resultBuilder.ToString());</span><br><span class=\"line\">            LogInfo(<span class=\"string\">&quot;HTTP检测统计: 成功 &quot;</span> + successCount + <span class=\"string\">&quot;/&quot;</span> + _config.HttpTargets.Count);</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"keyword\">return</span> successCount &gt; <span class=\"number\">0</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 快速Ping单个主机</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 优化点：</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 1. 使用较短的超时时间(800ms)加快检测速度</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 2. 每次创建新的Ping实例，避免资源竞争</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 3. 简化异常处理，只返回成功/失败</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=&quot;host&quot;&gt;</span>目标主机IP地址<span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span>true表示Ping成功，false表示失败或超时<span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"built_in\">bool</span> <span class=\"title\">PingHostFast</span>(<span class=\"params\"><span class=\"built_in\">string</span> host</span>)</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">using</span> (<span class=\"keyword\">var</span> ping = <span class=\"keyword\">new</span> Ping())</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// 使用较短的超时时间加快检测速度</span></span><br><span class=\"line\">                    <span class=\"keyword\">var</span> reply = ping.Send(host, <span class=\"number\">800</span>);</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> reply != <span class=\"literal\">null</span> &amp;&amp; reply.Status == IPStatus.Success;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">catch</span> (Exception)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"comment\">// 发生任何异常都视为失败</span></span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 快速测试HTTP连接</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 技术要点：</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 1. 使用HEAD方法，只获取响应头，不下载内容</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 2. 设置较短的超时时间(2000ms)加快检测速度</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 3. 设置合适的User-Agent，避免被某些服务拒绝</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 4. 关闭KeepAlive，避免连接池影响</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=&quot;url&quot;&gt;</span>目标URL地址<span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span>true表示HTTP请求成功，false表示失败或超时<span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"built_in\">bool</span> <span class=\"title\">TestHttpConnectionFast</span>(<span class=\"params\"><span class=\"built_in\">string</span> url</span>)</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"comment\">// 创建HTTP请求</span></span><br><span class=\"line\">                <span class=\"keyword\">var</span> request = WebRequest.Create(url) <span class=\"keyword\">as</span> HttpWebRequest;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (request == <span class=\"literal\">null</span>)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                </span><br><span class=\"line\">                <span class=\"comment\">// 配置请求参数</span></span><br><span class=\"line\">                request.Timeout = <span class=\"number\">2000</span>;  <span class=\"comment\">// 2秒超时</span></span><br><span class=\"line\">                request.Method = <span class=\"string\">&quot;HEAD&quot;</span>; <span class=\"comment\">// 使用HEAD方法</span></span><br><span class=\"line\">                request.UserAgent = <span class=\"string\">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36&quot;</span>;</span><br><span class=\"line\">                request.Accept = <span class=\"string\">&quot;*/*&quot;</span>;</span><br><span class=\"line\">                request.KeepAlive = <span class=\"literal\">false</span>;</span><br><span class=\"line\">                </span><br><span class=\"line\">                <span class=\"comment\">// 发送请求并获取响应</span></span><br><span class=\"line\">                <span class=\"keyword\">using</span> (<span class=\"keyword\">var</span> response = request.GetResponse() <span class=\"keyword\">as</span> HttpWebResponse)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (response != <span class=\"literal\">null</span>)</span><br><span class=\"line\">                    &#123;</span><br><span class=\"line\">                        <span class=\"comment\">// 2xx状态码都视为成功</span></span><br><span class=\"line\">                        <span class=\"keyword\">return</span> (<span class=\"built_in\">int</span>)response.StatusCode &gt;= <span class=\"number\">200</span> &amp;&amp; (<span class=\"built_in\">int</span>)response.StatusCode &lt;= <span class=\"number\">299</span>;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">catch</span> (WebException ex)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"comment\">// WebException特殊处理：尝试获取响应状态码</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (ex.Response != <span class=\"literal\">null</span>)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">using</span> (<span class=\"keyword\">var</span> response = ex.Response <span class=\"keyword\">as</span> HttpWebResponse)</span><br><span class=\"line\">                    &#123;</span><br><span class=\"line\">                        <span class=\"keyword\">if</span> (response != <span class=\"literal\">null</span>)</span><br><span class=\"line\">                        &#123;</span><br><span class=\"line\">                            <span class=\"comment\">// 即使发生WebException，如果返回2xx状态码也算成功</span></span><br><span class=\"line\">                            <span class=\"keyword\">return</span> (<span class=\"built_in\">int</span>)response.StatusCode &gt;= <span class=\"number\">200</span> &amp;&amp; (<span class=\"built_in\">int</span>)response.StatusCode &lt;= <span class=\"number\">299</span>;</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">catch</span> (Exception)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"comment\">// 其他异常都视为失败</span></span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"meta\">#<span class=\"keyword\">endregion</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"meta\">#<span class=\"keyword\">region</span> 用户活动检测</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 检测用户输入活动</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 检测原理：</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 1. 通过Windows API获取系统最后输入时间</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 2. 计算当前时间与最后输入时间的差值</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 3. 如果差值小于阈值，则认为用户有活动</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 注意：只检测键盘和鼠标输入活动</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span>true表示用户有输入活动，false表示用户空闲<span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"built_in\">bool</span> <span class=\"title\">HasUserInputActivity</span>()</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"built_in\">uint</span> idleTimeMs = GetUserIdleTime();</span><br><span class=\"line\">                <span class=\"built_in\">uint</span> thresholdMs = (<span class=\"built_in\">uint</span>)_config.UserIdleThresholdSeconds * <span class=\"number\">1000</span>;</span><br><span class=\"line\">                <span class=\"built_in\">bool</span> hasActivity = idleTimeMs &lt; thresholdMs;</span><br><span class=\"line\">                </span><br><span class=\"line\">                <span class=\"comment\">// 记录详细的空闲时间信息</span></span><br><span class=\"line\">                LogInfo(<span class=\"string\">&quot;用户活动检测: &quot;</span> + (hasActivity ? <span class=\"string\">&quot;有活动&quot;</span> : <span class=\"string\">&quot;无活动&quot;</span>) + </span><br><span class=\"line\">                       <span class=\"string\">&quot; (空闲时间: &quot;</span> + (idleTimeMs / <span class=\"number\">1000</span>) + <span class=\"string\">&quot; 秒)&quot;</span>);</span><br><span class=\"line\">                </span><br><span class=\"line\">                <span class=\"keyword\">return</span> hasActivity;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">catch</span> (Exception ex)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"comment\">// 用户活动检测失败时，默认返回无活动（保守策略）</span></span><br><span class=\"line\">                LogError(<span class=\"string\">&quot;用户活动检测异常&quot;</span>, ex);</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 获取用户空闲时间（毫秒）</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 实现方式：</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 1. 调用GetLastInputInfo获取系统最后输入时间</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 2. 计算当前系统运行时间与最后输入时间的差值</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 3. 返回用户空闲的毫秒数</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 注意：Environment.TickCount在49.7天后会回绕，但这里影响不大</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span>用户空闲时间（毫秒）<span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"built_in\">uint</span> <span class=\"title\">GetUserIdleTime</span>()</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">var</span> lastInputInfo = <span class=\"keyword\">new</span> LASTINPUTINFO();</span><br><span class=\"line\">            lastInputInfo.cbSize = (<span class=\"built_in\">uint</span>)Marshal.SizeOf(lastInputInfo);</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"keyword\">if</span> (GetLastInputInfo(<span class=\"keyword\">ref</span> lastInputInfo))</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"comment\">// 计算空闲时间 = 当前时间 - 最后输入时间</span></span><br><span class=\"line\">                <span class=\"keyword\">return</span> (<span class=\"built_in\">uint</span>)Environment.TickCount - lastInputInfo.dwTime;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"comment\">// API调用失败时返回最大值，表示用户已长时间空闲</span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"built_in\">uint</span>.MaxValue;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"meta\">#<span class=\"keyword\">endregion</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"meta\">#<span class=\"keyword\">region</span> 关机操作</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 执行关机操作</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 执行步骤：</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 1. 检查管理员权限</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 2. 使用shutdown.exe执行关机命令</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 3. 设置立即关机(/s /f /t 0)</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 参数说明：</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> /s: 关机</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> /f: 强制关闭所有应用程序</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> /t 0: 延迟0秒</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">ExecuteShutdown</span>()</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                LogWarning(<span class=\"string\">&quot;已达到关机条件，准备执行关机操作&quot;</span>);</span><br><span class=\"line\">                </span><br><span class=\"line\">                <span class=\"comment\">// 权限检查：关机需要管理员权限</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (!IsRunningAsAdministrator())</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    LogError(<span class=\"string\">&quot;执行关机操作需要管理员权限，请以管理员身份运行本程序&quot;</span>);</span><br><span class=\"line\">                    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                </span><br><span class=\"line\">                <span class=\"comment\">// 配置关机命令参数</span></span><br><span class=\"line\">                <span class=\"keyword\">var</span> psi = <span class=\"keyword\">new</span> ProcessStartInfo</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    FileName = <span class=\"string\">&quot;shutdown.exe&quot;</span>,</span><br><span class=\"line\">                    Arguments = <span class=\"string\">&quot;/s /f /t 0&quot;</span>,</span><br><span class=\"line\">                    CreateNoWindow = <span class=\"literal\">true</span>,</span><br><span class=\"line\">                    UseShellExecute = <span class=\"literal\">false</span></span><br><span class=\"line\">                &#125;;</span><br><span class=\"line\">                </span><br><span class=\"line\">                <span class=\"comment\">// 执行关机命令</span></span><br><span class=\"line\">                <span class=\"keyword\">using</span> (<span class=\"keyword\">var</span> process = Process.Start(psi))</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// 等待命令执行</span></span><br><span class=\"line\">                    Thread.Sleep(<span class=\"number\">1000</span>);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                </span><br><span class=\"line\">                LogWarning(<span class=\"string\">&quot;关机命令已发送，系统将立即关闭&quot;</span>);</span><br><span class=\"line\">                Stop(); <span class=\"comment\">// 停止程序主循环</span></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">catch</span> (Exception ex)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                LogError(<span class=\"string\">&quot;执行关机操作失败&quot;</span>, ex);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 检查是否以管理员权限运行</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 实现方式：</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 1. 获取当前Windows身份标识</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 2. 检查是否属于Administrators组</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 注意：Windows Vista及以上版本需要UAC提升</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;returns&gt;</span>true表示以管理员权限运行，false表示不是管理员<span class=\"doctag\">&lt;/returns&gt;</span></span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"built_in\">bool</span> <span class=\"title\">IsRunningAsAdministrator</span>()</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"keyword\">var</span> identity = System.Security.Principal.WindowsIdentity.GetCurrent();</span><br><span class=\"line\">                <span class=\"keyword\">var</span> principal = <span class=\"keyword\">new</span> System.Security.Principal.WindowsPrincipal(identity);</span><br><span class=\"line\">                <span class=\"keyword\">return</span> principal.IsInRole(System.Security.Principal.WindowsBuiltInRole.Administrator);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">catch</span></span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"comment\">// 权限检查失败时，默认返回false（保守策略）</span></span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">false</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"meta\">#<span class=\"keyword\">endregion</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"meta\">#<span class=\"keyword\">region</span> 日志输出</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 输出程序标题和配置信息</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">PrintBanner</span>()</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            Console.WriteLine(<span class=\"string\">&quot;===============================================&quot;</span>);</span><br><span class=\"line\">            Console.WriteLine(<span class=\"string\">&quot;网络空闲关机程序 - NetIdleShutdown&quot;</span>);</span><br><span class=\"line\">            Console.WriteLine(<span class=\"string\">&quot;版本: 1.0&quot;</span>);</span><br><span class=\"line\">            Console.WriteLine(<span class=\"string\">&quot;作者: System&quot;</span>);</span><br><span class=\"line\">            Console.WriteLine(<span class=\"string\">&quot;===============================================&quot;</span>);</span><br><span class=\"line\">            Console.WriteLine(<span class=\"string\">&quot;功能说明:&quot;</span>);</span><br><span class=\"line\">            Console.WriteLine(<span class=\"string\">&quot;- 当网络断开且用户无操作时，自动执行关机&quot;</span>);</span><br><span class=\"line\">            Console.WriteLine(<span class=\"string\">&quot;- 检测策略: 双重检测 (Ping + HTTP)&quot;</span>);</span><br><span class=\"line\">            Console.WriteLine(<span class=\"string\">&quot;- 检测方式: 并行多线程检测&quot;</span>);</span><br><span class=\"line\">            Console.WriteLine(<span class=\"string\">&quot;===============================================&quot;</span>);</span><br><span class=\"line\">            Console.WriteLine(<span class=\"string\">&quot;当前配置:&quot;</span>);</span><br><span class=\"line\">            Console.WriteLine(<span class=\"string\">&quot;- 无网络关机阈值: &quot;</span> + _config.MaxNoNetMinutes + <span class=\"string\">&quot; 分钟&quot;</span>);</span><br><span class=\"line\">            Console.WriteLine(<span class=\"string\">&quot;- 检测间隔: &quot;</span> + _config.CheckIntervalSeconds + <span class=\"string\">&quot; 秒&quot;</span>);</span><br><span class=\"line\">            Console.WriteLine(<span class=\"string\">&quot;- 用户空闲阈值: &quot;</span> + _config.UserIdleThresholdSeconds + <span class=\"string\">&quot; 秒&quot;</span>);</span><br><span class=\"line\">            Console.WriteLine(<span class=\"string\">&quot;- Ping检测目标: &quot;</span> + _config.PingTargets.Count + <span class=\"string\">&quot; 个&quot;</span>);</span><br><span class=\"line\">            Console.WriteLine(<span class=\"string\">&quot;- HTTP检测目标: &quot;</span> + _config.HttpTargets.Count + <span class=\"string\">&quot; 个&quot;</span>);</span><br><span class=\"line\">            Console.WriteLine(<span class=\"string\">&quot;===============================================&quot;</span>);</span><br><span class=\"line\">            Console.WriteLine(<span class=\"string\">&quot;&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 记录信息级别日志</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 用于记录程序正常运行状态信息</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=&quot;message&quot;&gt;</span>日志消息<span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">LogInfo</span>(<span class=\"params\"><span class=\"built_in\">string</span> message</span>)</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            Console.WriteLine(<span class=\"string\">&quot;[&quot;</span> + DateTime.Now.ToString(<span class=\"string\">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>) + <span class=\"string\">&quot;] [INFO] &quot;</span> + message);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 记录警告级别日志</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 用于记录需要注意但不影响程序继续运行的情况</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=&quot;message&quot;&gt;</span>日志消息<span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">LogWarning</span>(<span class=\"params\"><span class=\"built_in\">string</span> message</span>)</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            Console.WriteLine(<span class=\"string\">&quot;[&quot;</span> + DateTime.Now.ToString(<span class=\"string\">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>) + <span class=\"string\">&quot;] [WARN] &quot;</span> + message);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 记录错误级别日志</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 用于记录程序运行中的错误和异常</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=&quot;message&quot;&gt;</span>日志消息<span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=&quot;ex&quot;&gt;</span>异常对象（可选）<span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">LogError</span>(<span class=\"params\"><span class=\"built_in\">string</span> message, Exception ex = <span class=\"literal\">null</span></span>)</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            Console.WriteLine(<span class=\"string\">&quot;[&quot;</span> + DateTime.Now.ToString(<span class=\"string\">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>) + <span class=\"string\">&quot;] [ERROR] &quot;</span> + message);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (ex != <span class=\"literal\">null</span>)</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                Console.WriteLine(<span class=\"string\">&quot;[&quot;</span> + DateTime.Now.ToString(<span class=\"string\">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>) + <span class=\"string\">&quot;] [ERROR] 异常类型: &quot;</span> + ex.GetType().Name);</span><br><span class=\"line\">                Console.WriteLine(<span class=\"string\">&quot;[&quot;</span> + DateTime.Now.ToString(<span class=\"string\">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>) + <span class=\"string\">&quot;] [ERROR] 异常消息: &quot;</span> + ex.Message);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"meta\">#<span class=\"keyword\">endregion</span></span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"meta\">#<span class=\"keyword\">region</span> 资源清理</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 释放程序资源</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 实现IDisposable接口，支持using语句</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Dispose</span>()</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            _isRunning = <span class=\"literal\">false</span>;</span><br><span class=\"line\">            LogInfo(<span class=\"string\">&quot;程序资源已释放&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"meta\">#<span class=\"keyword\">endregion</span></span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> 程序主入口类</span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> 包含Main方法和程序启动逻辑</span></span><br><span class=\"line\">    <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">class</span> <span class=\"title\">Program</span></span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 应用程序主入口点</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> </span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 主要流程：</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 1. 创建NetIdleShutdown实例</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 2. 设置Ctrl+C中断处理</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 3. 运行网络检测主循环</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> 4. 处理异常并优雅退出</span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;/summary&gt;</span></span></span><br><span class=\"line\">        <span class=\"comment\"><span class=\"doctag\">///</span> <span class=\"doctag\">&lt;param name=&quot;args&quot;&gt;</span>命令行参数（当前版本未使用）<span class=\"doctag\">&lt;/param&gt;</span></span></span><br><span class=\"line\">        <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">Main</span>(<span class=\"params\"><span class=\"built_in\">string</span>[] <span class=\"keyword\">args</span></span>)</span></span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            Console.WriteLine(<span class=\"string\">&quot;[&quot;</span> + DateTime.Now.ToString(<span class=\"string\">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>) + <span class=\"string\">&quot;] [SYSTEM] 程序启动中...&quot;</span>);</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"keyword\">using</span> (<span class=\"keyword\">var</span> shutdown = <span class=\"keyword\">new</span> NetIdleShutdown())</span><br><span class=\"line\">            &#123;</span><br><span class=\"line\">                <span class=\"comment\">// 设置控制台关闭事件处理（Ctrl+C）</span></span><br><span class=\"line\">                Console.CancelKeyPress += (sender, e) =&gt;</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    Console.WriteLine(<span class=\"string\">&quot;[&quot;</span> + DateTime.Now.ToString(<span class=\"string\">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>) + <span class=\"string\">&quot;] [SYSTEM] 收到中断信号，正在停止程序...&quot;</span>);</span><br><span class=\"line\">                    shutdown.Stop();</span><br><span class=\"line\">                    e.Cancel = <span class=\"literal\">true</span>; <span class=\"comment\">// 防止程序立即退出</span></span><br><span class=\"line\">                &#125;;</span><br><span class=\"line\">                </span><br><span class=\"line\">                <span class=\"keyword\">try</span></span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    Console.WriteLine(<span class=\"string\">&quot;[&quot;</span> + DateTime.Now.ToString(<span class=\"string\">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>) + <span class=\"string\">&quot;] [SYSTEM] 程序已启动，开始网络监控&quot;</span>);</span><br><span class=\"line\">                    shutdown.Run();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">catch</span> (Exception ex)</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    Console.WriteLine(<span class=\"string\">&quot;[&quot;</span> + DateTime.Now.ToString(<span class=\"string\">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>) + <span class=\"string\">&quot;] [SYSTEM] 程序运行失败: &quot;</span> + ex.Message);</span><br><span class=\"line\">                    Environment.Exit(<span class=\"number\">1</span>);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            </span><br><span class=\"line\">            Console.WriteLine(<span class=\"string\">&quot;[&quot;</span> + DateTime.Now.ToString(<span class=\"string\">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>) + <span class=\"string\">&quot;] [SYSTEM] 程序已退出&quot;</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>成品 <a href=\"https://github.com/utgnim/NetIdleShutdown.cs/raw/refs/heads/master/NetIdleShutdown.cs\">NetIdleShutdown.cs</a></p>\n<p>3 分钟版 <a href=\"https://github.com/utgnim/NetIdleShutdown.cs/raw/refs/heads/master/3minNetIdleShutdown.exe\">3minNetIdleShutdown.exe</a></p>\n<p>30 分钟版 <a href=\"https://github.com/utgnim/NetIdleShutdown.cs/raw/refs/heads/master/30minNetIdleShutdown.exe\">30minNetIdleShutdown.exe</a></p>\n<p>GitHub地址 <a href=\"https://github.com/utgnim/NetIdleShutdown.cs.git\">https://github.com/utgnim/NetIdleShutdown.cs.git</a></p>\n",
            "tags": [
                "技术"
            ]
        },
        {
            "id": "https://utgnim.github.io/%E6%B5%AE%E7%94%9F%E5%85%AD%E8%AE%B0-%E5%8D%B7%E4%B8%80-%E9%97%BA%E6%88%BF%E8%AE%B0%E4%B9%90-%E4%BA%8C%E5%8D%81%E4%BA%8C/",
            "url": "https://utgnim.github.io/%E6%B5%AE%E7%94%9F%E5%85%AD%E8%AE%B0-%E5%8D%B7%E4%B8%80-%E9%97%BA%E6%88%BF%E8%AE%B0%E4%B9%90-%E4%BA%8C%E5%8D%81%E4%BA%8C/",
            "title": "浮生六记-卷一-闺房记乐-二十二",
            "date_published": "2026-01-27T13:15:45.000Z",
            "content_html": "<p>离余家半里许，醋库巷有洞庭君祠，俗呼水仙庙。</p>\n<p>回廊曲折，小有园亭，每逢神诞，众姓各认一落，密悬一式之玻璃灯，中设宝座，旁列瓶几，插花陈设，以较胜负。日惟演戏，夜则参差高下，插烛于瓶花间，名曰“花照”。花光灯影，宝鼎香浮，若龙宫夜宴。司事者或笙箫歌唱，或煮茗清谈，观者如蚁集，檐下皆设栏为限。</p>\n<p>余为众友邀去，插花布置，因得躬逢其盛。归家向芸艳称之，芸曰：“惜妾非男子，不能往。”余曰：“冠我冠，衣我衣，亦化女为男之法也。”于是易髻为辫，添扫蛾眉；加余冠，微露两鬓，尚可掩饰；服余衣，长一寸又半，于腰内折而缝之，外加马褂。芸曰：“脚下将奈何？”余曰：“坊间有蝴蝶履，大小由之，购之极易，且早晚可代撒鞋之用，不亦善乎？”芸欣然。</p>\n<p>及晚餐后，装束既毕，效男子拱手阔步良久，忽变卦曰：“妾不去矣，为人识出，既不便，堂上闻之又不可。”余怂恿曰：“庙中司事者谁不知我，既识出，亦不过付之一笑耳。吾母现在九妹丈家，密去密来，焉得知之。”</p>\n<p>芸揽镜自照，狂笑不已。余强挽之，悄然径去。遍游庙中，无识出为女子者。或问何人，以表弟对，拱手而已。</p>\n<p>最后到一处，有少妇、幼女坐于所设宝座后，乃杨姓司事者之眷属也。芸忽趋彼通款曲，身一侧，而不觉一按少妇之肩，旁有婢媪怒而起曰：“何物狂生，不法乃尔！”余试为措词掩饰，芸见势恶，即脱帽翘足示之曰：“我亦女子耳。”相与愕然，转怒为欢，留茶点，唤扁舆送归。</p>\n",
            "tags": [
                "抄书",
                "练字"
            ]
        },
        {
            "id": "https://utgnim.github.io/%E5%85%B3%E4%BA%8E-Windows-Server-2022-%E5%AE%89%E8%A3%85%E5%9C%A8%E7%AC%94%E8%AE%B0%E6%9C%AC%E4%B8%8A%E4%B8%80%E4%BA%9B%E5%86%85%E5%AE%B9%E6%95%B4%E7%90%86%E5%8F%82%E8%80%83/",
            "url": "https://utgnim.github.io/%E5%85%B3%E4%BA%8E-Windows-Server-2022-%E5%AE%89%E8%A3%85%E5%9C%A8%E7%AC%94%E8%AE%B0%E6%9C%AC%E4%B8%8A%E4%B8%80%E4%BA%9B%E5%86%85%E5%AE%B9%E6%95%B4%E7%90%86%E5%8F%82%E8%80%83/",
            "title": "关于 Windows Server 2022 安装在笔记本上一些内容整理参考",
            "date_published": "2025-09-29T12:07:31.000Z",
            "content_html": "<p>近来心血来潮想给笔记本电脑重装系统，遇到的一些问题及解决方案，遂记录汇总；</p>\n<p>前人栽树，后人乘凉，感谢各位大大的帖子指引，帮助很多；</p>\n<p>本方案基于 zh-cn_windows_server_2022_x64_dvd_6c73507d.iso 进行，未在其他系统镜像上进行过测试，因此不保证通用性。</p>\n<h2 id=\"正文\"><a href=\"#正文\" class=\"headerlink\" title=\"正文\"></a>正文</h2><h2 id=\"一、安装\"><a href=\"#一、安装\" class=\"headerlink\" title=\"一、安装\"></a>一、安装</h2><h3 id=\"镜像下载：\"><a href=\"#镜像下载：\" class=\"headerlink\" title=\"镜像下载：\"></a>镜像下载：</h3><p>最初版本：</p>\n<p>BT下载：</p>\n<p>magnet:?xt&#x3D;urn:btih:0A63B2E08D5D154A79D408040BE4994917C223D3&amp;dn&#x3D;zh-cn_windows_server_2022_x64_dvd_6c73507d.iso</p>\n<p>123盘：<a href=\"https://www.123pan.com/s/iBU9jv-zYJNh.html\">https://www.123pan.com/s/iBU9jv-zYJNh.html</a> （123盘电脑浏览器解除限速下载限制，可使用油猴脚本 <a href=\"https://github.com/hmjz100/LinkSwift\">https://github.com/hmjz100/LinkSwift</a> ）</p>\n<p>Windows Server 2022 (x64) - DVD (Chinese-Simplified)</p>\n<p>文件：zh-cn_windows_server_2022_x64_dvd_6c73507d.iso</p>\n<p>大小：5.41GB</p>\n<p>MD5：A93A5845D924F99ADEC1432A5D69103B</p>\n<p>SHA1：0DF46441DD01F99459FB75BDB732E7904900A0D7</p>\n<p>SHA256：E77BB4618182D1E5D0B39DA7E72354F4167EBB859428E7482587DD5A2A72F599</p>\n<p>资源来自：</p>\n<p><a href=\"https://next.itellyou.cn/\">https://next.itellyou.cn/</a></p>\n<p><a href=\"https://hellowindows.cn/\">https://hellowindows.cn/</a></p>\n<p>最新版本可在远景论坛内各大大发布的资源贴内下载</p>\n<h2 id=\"二、调整优化\"><a href=\"#二、调整优化\" class=\"headerlink\" title=\"二、调整优化\"></a>二、调整优化</h2><p>具体操作步骤大致如下：</p>\n<ol>\n<li>全新安装 Windows 10 或 Windows 11，安装全部驱动，确保各功能（触控板、指纹等）可正常使用</li>\n<li>使用 Dism++ [ <a href=\"https://github.com/Chuyu-Team/Dism-Multi-language/releases\">https://github.com/Chuyu-Team/Dism-Multi-language/releases</a> ] 中的 驱动管理 导出驱动（不要勾选 显示适配器，也即显卡的驱动）到非系统盘中的任意文件夹中（以下将该目录称为【驱动备份目录】）</li>\n<li>下载帖子 分享国外大神提供的Server 2022 蓝牙HID驱动，解决蓝牙外设能配对不能连接的问题 [ <a href=\"https://bbs.pcbeta.com/viewthread-1942811-1-1.html\">https://bbs.pcbeta.com/viewthread-1942811-1-1.html</a> ] 中的附件【Bluetooth_HID.zip 】，解压到上面的的【驱动备份目录】中</li>\n<li>解压下载的 zh-cn_windows_server_2022_x64_dvd_6c73507d.iso 镜像文件到一个目录（下称【镜像目录】），使用 Dism++ 挂载该目录下的 install.wim ，目标镜像 记得选择带图形化界面的（比如 Windows Server 2022 Standard (Desktop Experience) 或者 Windows Server 2022 Datacenter (Desktop Experience)）</li>\n<li>使用 Dism++ 中的 驱动管理 功能中的 添加驱动【驱动备份目录】中的驱动到挂载的镜像中，然后 保存镜像 选择 增量保存，最后 卸载镜像</li>\n<li>通过 微PE 等 PE 系统 或者直接启动【镜像目录】中的镜像 安装修改后的镜像</li>\n<li>参考帖子 Server 2022 改造为个人工作站系统的调整和优化 [ <a href=\"https://bbs.pcbeta.com/viewthread-1911508-1-1.html\">https://bbs.pcbeta.com/viewthread-1911508-1-1.html</a> ] 中的内容进行调整</li>\n</ol>\n<h2 id=\"三、驱动问题\"><a href=\"#三、驱动问题\" class=\"headerlink\" title=\"三、驱动问题\"></a>三、驱动问题</h2><p>到这一步 触控板 和 指纹 还无法使用</p>\n<p>『可能还有 蓝牙音频驱动 无法解决，但由于本人没有蓝牙音频设备，无法进行测试，仅提供解决方法指引 让server 2022 支持蓝牙耳机的方法，测试可用，请用V3附件 [ <a href=\"https://bbs.pcbeta.com/viewthread-1930349-1-1.html\">https://bbs.pcbeta.com/viewthread-1930349-1-1.html</a> ]』</p>\n<h3 id=\"触控板解决方案（自签名思路，无需开启测试模式即可加载驱动）\"><a href=\"#触控板解决方案（自签名思路，无需开启测试模式即可加载驱动）\" class=\"headerlink\" title=\"触控板解决方案（自签名思路，无需开启测试模式即可加载驱动）\"></a>触控板解决方案（自签名思路，无需开启测试模式即可加载驱动）</h3><ol>\n<li>使用 7z 打开【镜像目录】中的 \\sources\\boot.wim ，提取  \\1\\Windows\\INF 中的 hidi2c.inf 文件和 \\1\\Windows\\System32\\drivers 中的 hidi2c.sys 文件到一个目录中（下称【触控板驱动】）</li>\n<li>参考 [<a href=\"https://github.com/PIKACHUIM/FakeSign]\">https://github.com/PIKACHUIM/FakeSign]</a> 进行签名<br>• 需要安装时间证书信任工具 [ <a href=\"https://github.com/PIKACHUIM/FakeSign/raw/refs/heads/main/Releases/PikachuTestCert.exe\">https://github.com/PIKACHUIM/FakeSign/raw/refs/heads/main/Releases/PikachuTestCert.exe</a> ]<br>• 需要安装 WDK [ <a href=\"https://learn.microsoft.com/zh-cn/windows-hardware/drivers/download-the-wdk\">https://learn.microsoft.com/zh-cn/windows-hardware/drivers/download-the-wdk</a> ]，并根据安装目录自行设置环境变量，如 C:\\Program Files (x86)\\Windows Kits\\10\\bin\\10.0.***.0\\x86，确保 inf2cat.exe 能被 cmd 直接调用<br>• 但是中间会出现问题，不允许把系统文件“重新打包”进驱动目录的错误，需要改 hidi2c.inf 安装  hidi2c.sys  驱动为绑定 hidi2c.sys 驱动，于是请 Microsoft Copilot 写了一个针对自己设备 硬件ID 的 hidi2c-elan-bind.inf 文件，利用该方法签名，安装后，触控板即恢复正常</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">; hidi2c-elan-bind.inf</span><br><span class=\"line\">; Bind ELAN2203 I2C HID devices to the in-box Microsoft hidi2c.sys without redistributing binaries.</span><br><span class=\"line\"></span><br><span class=\"line\">[Version]</span><br><span class=\"line\">Signature   = &quot;$Windows NT$&quot;</span><br><span class=\"line\">Class       = HIDClass</span><br><span class=\"line\">ClassGuid   = &#123;745a17a0-74d3-11d0-b6fe-00a0c90f57da&#125;</span><br><span class=\"line\">Provider    = %MSFT%</span><br><span class=\"line\">DriverVer = 01/01/2015,1.0.1.0</span><br><span class=\"line\">CatalogFile = hidi2c_elan_bind.cat</span><br><span class=\"line\"></span><br><span class=\"line\">[ControlFlags]</span><br><span class=\"line\">ExcludeFromSelect = *</span><br><span class=\"line\"></span><br><span class=\"line\">[Manufacturer]</span><br><span class=\"line\">%MSFT% = Microsoft, NTx86, NTamd64</span><br><span class=\"line\"></span><br><span class=\"line\">[Microsoft.NTx86]</span><br><span class=\"line\">%ELAN.DeviceDesc% = hidi2c.Bind.Install, ACPI\\VEN_ELAN&amp;DEV_2203</span><br><span class=\"line\">%ELAN.DeviceDesc% = hidi2c.Bind.Install, ACPI\\ELAN2203</span><br><span class=\"line\">%ELAN.DeviceDesc% = hidi2c.Bind.Install, *ELAN2203</span><br><span class=\"line\"></span><br><span class=\"line\">[Microsoft.NTamd64]</span><br><span class=\"line\">%ELAN.DeviceDesc% = hidi2c.Bind.Install, ACPI\\VEN_ELAN&amp;DEV_2203</span><br><span class=\"line\">%ELAN.DeviceDesc% = hidi2c.Bind.Install, ACPI\\ELAN2203</span><br><span class=\"line\">%ELAN.DeviceDesc% = hidi2c.Bind.Install, *ELAN2203</span><br><span class=\"line\"></span><br><span class=\"line\">; Bind to the in-box hidi2c installation logic (no CopyFiles, no ServiceBinary)</span><br><span class=\"line\">[hidi2c.Bind.Install]</span><br><span class=\"line\">Include = hidi2c.inf</span><br><span class=\"line\">Needs   = hidi2c_Device.NT</span><br><span class=\"line\"></span><br><span class=\"line\">[hidi2c.Bind.Install.HW]</span><br><span class=\"line\">Include = hidi2c.inf</span><br><span class=\"line\">Needs   = hidi2c_Device.NT.HW</span><br><span class=\"line\">AddReg  = hidi2c_Device.Configuration.AddReg.Override</span><br><span class=\"line\"></span><br><span class=\"line\">[hidi2c.Bind.Install.Services]</span><br><span class=\"line\">Include = hidi2c.inf</span><br><span class=\"line\">Needs   = hidi2c_Device.NT.Services</span><br><span class=\"line\"></span><br><span class=\"line\">; Optional: override/append device configuration values (safe per-device HKR writes)</span><br><span class=\"line\">[hidi2c_Device.Configuration.AddReg.Override]</span><br><span class=\"line\">HKR,,&quot;EnhancedPowerManagementEnabled&quot;,0x00010001,1</span><br><span class=\"line\">HKR,,&quot;DeviceResetNotificationEnabled&quot;,0x00010001,1</span><br><span class=\"line\">HKR,,&quot;LegacyTouchScaling&quot;,0x00010001,0</span><br><span class=\"line\"></span><br><span class=\"line\">[Strings]</span><br><span class=\"line\">MSFT             = &quot;Microsoft&quot;</span><br><span class=\"line\">ELAN.DeviceDesc  = &quot;ELAN I2C HID Device (Bind to in-box hidi2c)&quot;</span><br></pre></td></tr></table></figure>\n\n\n<p>特别注意</p>\n<p>提供的文件不能直接使用，需要 更改为 你自己的设备 硬件ID，然后重新签名；</p>\n<p>微软有一个黑名单会禁止使用这些签名用的泄露的证书，如果你系统里的 黑名单 中有为驱动签名的证书，那可能就无法使用该方法了；</p>\n<p>有帖子 windows10及以上本地驱动加载黑名单查看 [ <a href=\"https://bbs.kanxue.com/thread-273316.htm\">https://bbs.kanxue.com/thread-273316.htm</a> ] 提供有修改该黑名单的方法，但本人没有验证过，无法确定更改后是否即可恢复正常；</p>\n<p>如果你信任我，也可以发 硬件ID 和 驱动文件 给我，我可以帮你签。当然“我不能保证这个文件一定能工作，也不能保证它不会损坏你的计算机，你将需要自行承担可能存在的风险。”</p>\n<p>参考资料<br>Windows Server 2019&#x2F;2022 i2c 触摸屏&#x2F;触摸板无法使用的解决方法 [ <a href=\"https://www.bilibili.com/opus/884213704738996247\">https://www.bilibili.com/opus/884213704738996247</a> ]</p>\n<hr>\n<h3 id=\"指纹解决方案（通过替换-CredentialEnrollmentManager-exe-解锁）\"><a href=\"#指纹解决方案（通过替换-CredentialEnrollmentManager-exe-解锁）\" class=\"headerlink\" title=\"指纹解决方案（通过替换 CredentialEnrollmentManager.exe 解锁）\"></a>指纹解决方案（通过替换 CredentialEnrollmentManager.exe 解锁）</h3><p>参考 给 Windows Server 2022 配置 Windows Hello 指纹解锁 [ <a href=\"https://afa31148-4a8c-4113-a92f-72626cd2a27b.x.wtf/2021/fingerprint-unlocking-for-windows-server-2022/\">https://afa31148-4a8c-4113-a92f-72626cd2a27b.x.wtf/2021/fingerprint-unlocking-for-windows-server-2022/</a> ]</p>\n<p>下面是请 Copilot 写的的替换命令，需要用到工具 NSudo [ <a href=\"https://github.com/M2TeamArchived/NSudo/releases\">https://github.com/M2TeamArchived/NSudo/releases</a> ]</p>\n<figure class=\"highlight bat\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">REM === 使用 NSudo 打开 TrustedInstaller 权限的命令行后，逐行执行以下命令 ===</span></span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\">REM Step 1: 备份原始文件和 ACL</span></span><br><span class=\"line\">takeown /f &quot;C:\\Windows\\System32\\CredentialEnrollmentManager.exe&quot;</span><br><span class=\"line\">icacls &quot;C:\\Windows\\System32\\CredentialEnrollmentManager.exe&quot; /save &quot;D:\\backup\\CredentialEnrollmentManager_acl.txt&quot;</span><br><span class=\"line\"><span class=\"built_in\">copy</span> &quot;C:\\Windows\\System32\\CredentialEnrollmentManager.exe&quot; &quot;D:\\backup\\CredentialEnrollmentManager.exe&quot;</span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\">REM Step 2: 替换为自定义文件</span></span><br><span class=\"line\"><span class=\"built_in\">copy</span> /Y &quot;D:\\..你下载文件保存的目录..\\CredentialEnrollmentManager.exe&quot; &quot;C:\\Windows\\System32\\CredentialEnrollmentManager.exe&quot;</span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\">REM Step 3: 恢复原始 ACL 权限</span></span><br><span class=\"line\">icacls &quot;C:\\Windows\\System32&quot; /<span class=\"built_in\">restore</span> &quot;D:\\backup\\CredentialEnrollmentManager_acl.txt&quot;</span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\">REM Step 4: 可选 - 设置只读属性，防止更新覆盖</span></span><br><span class=\"line\"><span class=\"built_in\">attrib</span> +R &quot;C:\\Windows\\System32\\CredentialEnrollmentManager.exe&quot;</span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\">REM Step 5: 可选 - 拒绝 TrustedInstaller 写入（需谨慎）</span></span><br><span class=\"line\">icacls &quot;C:\\Windows\\System32\\CredentialEnrollmentManager.exe&quot; /deny &quot;NT SERVICE\\TrustedInstaller&quot;:(W)</span><br><span class=\"line\"><span class=\"comment\"></span></span><br><span class=\"line\"><span class=\"comment\">REM === 回滚方法（如需恢复原始文件） ===</span></span><br><span class=\"line\"><span class=\"built_in\">copy</span> /Y &quot;D:\\backup\\CredentialEnrollmentManager.exe&quot; &quot;C:\\Windows\\System32\\CredentialEnrollmentManager.exe&quot;</span><br><span class=\"line\">icacls &quot;C:\\Windows\\System32&quot; /<span class=\"built_in\">restore</span> &quot;D:\\backup\\CredentialEnrollmentManager_acl.txt&quot;</span><br><span class=\"line\"><span class=\"built_in\">attrib</span> -R &quot;C:\\Windows\\System32\\CredentialEnrollmentManager.exe&quot;</span><br></pre></td></tr></table></figure>\n\n<p>然后你需要新建一个用户，切换到该用户才能使用指纹，但是这样一来就需要重新调整设置，不太优雅；</p>\n<p>因此我推荐使用 Forensit [ <a href=\"https://www.forensit.com/downloads.html\">https://www.forensit.com/downloads.html</a> ] 里的 User Profile Wizard Release 24 [ <a href=\"https://www.forensit.com/Downloads/Profwiz.msi\">https://www.forensit.com/Downloads/Profwiz.msi</a> ]，该工具可以直接将当前 Administrator 的用户配置迁移到 其他用户 下；</p>\n<p>需要注意的一点是新建用户后不注销，直接使用该工具迁移，似乎可以直接使用 C:\\Users\\Administrator 作为新用户的目录来使用，但我不确定这样操作是否正确，有没有隐患</p>\n<h2 id=\"四、其它可能用到的工具：\"><a href=\"#四、其它可能用到的工具：\" class=\"headerlink\" title=\"四、其它可能用到的工具：\"></a>四、其它可能用到的工具：</h2><p>Microsoft Activation Scripts (MAS): [ <a href=\"https://massgrave.dev/\">https://massgrave.dev/</a> ]</p>\n<p>Microsoft Defender &amp; Windows Update 开关 [ <a href=\"https://bbs.pcbeta.com/viewthread-1913968-1-1.html\">https://bbs.pcbeta.com/viewthread-1913968-1-1.html</a> ]</p>\n<p>微软常用运行库合集_By:Dreamcast [ <a href=\"https://wwa.lanzout.com/b0b8rs19a#9527\">https://wwa.lanzout.com/b0b8rs19a#9527</a> ]</p>\n<p>至此，安装结束！</p>\n<p>二〇二五年九月二十九日夜</p>\n<p>补充</p>\n<p>关于 蓝牙音频驱动 这个似乎可以用，但不清楚是否和系统自己带的  个人局域网服务  有什么区别，装上就没有叹号了，但我没有蓝牙音频设备无法测试设备是否可以正常连接使用，驱动程序提供商是 Broadcom</p>\n<p>下载来源：[ <a href=\"https://geek-speak.ru/download/driver-ms_bthpan/\">https://geek-speak.ru/download/driver-ms_bthpan/</a> ]</p>\n<p>病毒检测：[ <a href=\"https://www.virustotal.com/gui/file/82f5fda2dcb57419413b7a7284ce6e3c1b1049f43a44245e5e22e010fb73b34f\">https://www.virustotal.com/gui/file/82f5fda2dcb57419413b7a7284ce6e3c1b1049f43a44245e5e22e010fb73b34f</a> ]</p>\n<p>另外有个一劳永逸的方法，不用需要费力给驱动签名消除叹号，相当于每次开机默认以  关闭驱动程序强制验证  选项开机，缺点就是每次开机，开机界面都会有一堆命令显示</p>\n<p>纠正，需要每次开机重新执行一遍 EfiDSEFix.exe -d 才行，可以结合 任务计划程序 设置开机自动运行，并且加上  禁用  启用  没有数字签名的设备命令，需要用到 WDK 里的 devcon.exe</p>\n<p>项目地址：[ <a href=\"https://github.com/Mattiwatti/EfiGuard\">https://github.com/Mattiwatti/EfiGuard</a> ] （在 [ <a href=\"https://github.com/PIKACHUIM/FakeSign/issues/9\">https://github.com/PIKACHUIM/FakeSign/issues/9</a> ] 这里了解到该项目）</p>\n<p>使用的前提条件是  内存完整性（HVCI）为关闭状态</p>\n<p>步骤如下：</p>\n<ol>\n<li><p>下载 [ <a href=\"https://github.com/Mattiwatti/EfiGuard/releases/download/v1.4/EfiGuard-v1.4.zip\">https://github.com/Mattiwatti/EfiGuard/releases/download/v1.4/EfiGuard-v1.4.zip</a> ]，解压到任意目录（下称【EfiGuard 目录】 ），不要删除</p>\n</li>\n<li><p>使用 DiskGenius 或其他工具，将  EfiGuardDxe.efi  Loader.efi  两个文件复制到  \\EFI\\Boot 下面</p>\n</li>\n<li><p>配合 EasyUEFI 新建启动项，并设置为 Loader.efi ，然后将新建的启动项调整为首位，重启后界面会有命令执行过程显示</p>\n</li>\n<li><p>开机后，以管理员身份运行 命令行窗口，切换到【EfiGuard 目录】 执行 EfiDSEFix.exe -d ，就会禁用 Driver Signature Enforcement（驱动程序签名强制）</p>\n</li>\n</ol>\n<p>此时再安装没有经过微软签名的驱动，也不会有叹号出现了</p>\n<p>由于关闭了 驱动程序强制验证，以后安装程序要谨慎一点，否则电脑很容易中招</p>\n",
            "tags": [
                "技术"
            ]
        },
        {
            "id": "https://utgnim.github.io/%E8%AF%84%E6%99%AE%E9%B2%81%E5%A3%AB%E6%9C%80%E8%BF%91%E7%9A%84%E4%B9%A6%E6%8A%A5%E6%A3%80%E6%9F%A5%E4%BB%A4/",
            "url": "https://utgnim.github.io/%E8%AF%84%E6%99%AE%E9%B2%81%E5%A3%AB%E6%9C%80%E8%BF%91%E7%9A%84%E4%B9%A6%E6%8A%A5%E6%A3%80%E6%9F%A5%E4%BB%A4/",
            "title": "评普鲁士最近的书报检查令",
            "date_published": "2025-09-16T13:27:51.000Z",
            "content_html": "<p><strong>马克思</strong><br><strong>（1842 年 2 月）</strong></p>\n<p>《评旁观者最近的书报检查令》是卡尔·马克思的第一篇政论性文章，他的政治活动就是从这时开始的，当时他是一个革命民主主义者。</p>\n<p>19 世纪 40 年代初，德国正处于资产阶级革命的前夜，争取自由和民主的运动非常高涨，所以本文所谈到的问题，即关于普鲁士的出版状况问题，在当时显得特别尖锐。普鲁士政府于 1841 年 12 月 24 日颁布的新书报检查令，在表面上表示不赞成对作家的写作活动加以限制，实际上不仅保存了反动的普鲁士的书报检查制度，而且更加强了这种制度。</p>\n<p>马克思这篇揭露新检查令的虚伪自由主义的文章，没有在德国发表。这篇文章是在 1842 年 1 月 15 日至 2 月 10 日间写成的，但直到 1843 年 2 月才在瑞士发表，载于《德国现代哲学和政论界轶文集》（《Anekdota zur neuesten deutschen Philosophie und Publicistik》）第 1 卷。阿·卢格出版的这一文集（两卷集），除卡尔·马克思的两篇文章之外，还收集了布·鲍威尔、路·费尔巴哈、费·科本以及阿·卢格等人的文章。</p>\n<p>1851 年，海·贝克尔开始在科伦出版卡尔·马克思文集（Gesammelte Aufsatze von Karl Marx, herausgegeben von Hermann Becker. I. Heft, Koln, 1851），马克思把《评普鲁士最近的书报检查令》这一篇文章作为该文集的第一篇。由于普鲁士政府的查禁，这一版本在第一版出版后即被禁止发行</p>\n<hr>\n<p>我们不是那种心情不满的人，不会在普鲁士新的书报检查法令公布之前就声明说：Tieo Danaos et dona ferentes ［即便丹纳士人带来礼物，我还是怕他们］[1]。相反，因为新的检查令允许对已经颁布的法律进行讨论，哪怕这种讨论和政府的观点不一致，所能，我们现在就从这一检查令本身谈起。<strong>书报检查</strong>就是<strong>官方的批评</strong>。书报检查的标准就是批评的标准，因此，就很难把这种标准同批评分割开来，因为它们是建立同一个基础上的。</p>\n<p>当然，对于检查令序言中所表述的一般倾向，每个人都只能表示赞同：</p>\n<p>“为了使新闻出版<strong>现在就</strong>能摆脱那些未经许可的、违背陛下旨意的限制，国王陛下曾于本月 10 日下诏王室内阁，明确反对使写作活动受到各种无理的约束。国王陛下承认公正的、合乎礼貌的公众言论是重要的而且必需的，并授权我们再度现成书报检查官切实遵守 1819 年 10 月 18 日书报检查法令第 2 条的规定。”</p>\n<p>当然！既然书报检查是必要的，那么公正的、自由的书报检查就更加必要了。</p>\n<p>可是，这里有一点马上就会使人们感到有点诧异，那就是上述法律的<strong>日期</strong>。该法律颁布的日期是 1819 年 10 月 18 日。怎么？难道这是一项由于时势所迫而废除了的法律吗？看来不是，因为现在不过是“<strong>再度</strong>”现成书报检查官必须遵守这一法律。由此可见，这一法律 1842 年以前一直存在，不过没有实施罢了。正因为如此，现在才又提起它，“为了”使新闻出版“<strong>现在就</strong>能摆脱那些未经许可的、违背陛下旨意的限制。</p>\n<p><strong>尽管有了法律法律</strong>，但是新闻出版物到目前为止仍然受到种种未经许可的限制，这就是从上述书报检查令的序言中得出的直接结论。</p>\n<p>上面的话是<strong>针对法律</strong>，还是<strong>针对书报检查官</strong>呢？</p>\n<p>我们未必有理由能肯定说是后一种情况。在 22 年当中，保护公民的最高利益即<strong>他们的精神</strong>的主管机关，一直在进行非法的活动，这一机关的权力简直比罗马的书报检查官还要大，因为它不仅管理个别公民的行为，而且甚至管理公众精神的行为。在组织完善的、以自己的行政机关自豪的普鲁士国家里，政府高级官员的这种不负责任的行为。在组织完善的以自己的行政机关自豪的普鲁士国家里，政府高级官员的这种不负责任的行为，这种一贯的不忠诚的行为，难道可能发生吗？还是国家总是盲目地挑选最无能的人去担任最艰巨的职务呢？最后，也许是普鲁士国家的臣民已根本不可能起来抗议这种违法的行为吧？难道普鲁士的所有作者都如此愚昧无知，连与自己生存有关的法律也不知道吗？还是他们的胆子太小，竟不敢要求实施这种法律呢？</p>\n<p>假如我们把过错推在<strong>书报检查官</strong>身上，那么这不仅会败坏他们本身的名誉，而且会败坏普鲁士国家和普鲁士作者的名誉。</p>\n<p>况且，如果书报检查官二十多年来一直进行无视法律的非法活动，那就会提供 argumentum ad hominem ［令人信服的证据］[2]，说明新闻出版需要的是别的保证，而不是给如此不负责任的人物发出的这种一般性的指令。那就会证明书报检查制度骨子里隐藏着一种用任何法律者无法消除的根本缺陷。</p>\n<p>可是，如果说书报检查官很中用，<strong>不中用的是法律</strong>，那么，为什么还要再度求助于法律去反对正是它本身所造成的祸害呢？</p>\n<p>或者，也许为了造成一种改善的假象而不从本质上去改善事物，才需要把制度本身的<strong>客观缺点</strong>归咎于<strong>个人</strong>吧？<strong>虚伪自由主义</strong>的手法通常总是这样的：在被迫让步时，它就牺牲人这个工具，而保全事物本身，即制度。这进就会转移从表面看问题的公众的注意力。</p>\n<p>对事物本身的愤恨就会变成对某些人的愤恨。有些人以为人一变换，事物本身也就会起变化。人们的注意力就从书报检查制度转移到了个别书报检查官身上，而那一伙专看官方眼色行事的卑劣作者，便放心大胆地反对那些不受宠幸的人，对政府却称颂备至。</p>\n<p>在我们面前还有一个困难。</p>\n<p>某些报纸的记者认为，书报检查令就是新的书报检查法令。他们错了，不过他们的这种错误是情有可原的。1819 年 10 月 18 日的书报检查法令只应当暂时有效，即到 1823 年为止有效，如果不是现在的书报检查令告诉我们上述法令从来没有被实施过，那么直到今天它仍然是一项临时性的法律。</p>\n<p>1819 年的法令也是一项<strong>过渡性</strong>措施，不过，当时规定了一定的期限——五年，可以期望颁布永久性法律，而新的检查令却没有规定任何期限；其次，当时期望颁布的是关于<strong>新闻出版自由的法律</strong>，而<strong>现在</strong>期望颁布的则是关于<strong>书报检查的法律</strong>。</p>\n<p>另一些报纸的记者则认为，这个书报检查令是旧的书报检查法令的翻新。检查令本身将驳倒他们这种错误的看法。</p>\n<p>我们认为，书报检查令是可能要颁布的书报检查法的<strong>精神的预示</strong>。在这一点上，我们是严格遵循 1819 年书报检查法令的精神的，根据这一法令，邦的<strong>法律</strong>和<strong>命令</strong>对新闻出版具有同样的作用（参看上述法令第 16 条第 2 款）。</p>\n<p>现在我们再回过头来看看检查令。</p>\n<p>“根据这一法律〈即根据第 2 条规定〉书报检查不得阻挠人们对真理作严肃和谦逊的探讨，不得使作者受到无理的约束，不得妨碍书籍在书市上自由流通。”</p>\n<p>书报检查不得阻挠的对真理的探讨，在这里有了更具体的规定：这就是<strong>严肃</strong>和<strong>谦逊</strong>的探讨。这两个规定要求探讨注意的不是内容，而无宁说是内容以外的某种东西。这些规定一开始就使探讨脱离了真理，并硬要它把注意力转移到某个莫名其妙的第三者身上。可是，如果探讨老是去注意这个由法律赋予挑剔权的第三者，难道它不是会忽视真理吗？难道真理探讨者的首要义务不就是直奔真理，而不要东张西望吗？假如我必须记住用指定的形式来谈论事物，难道我不是会忘记谈论事物本身吗？</p>\n<p>真理像光一样，它很难谦逊；而且要它对谁谦逊呢？对它本身吗？Verum index sui et falsi ［真理是检验它自身和谬误的试金石］[3]。<strong>那么是以谬误吗</strong>？</p>\n<p>如果谦逊是探讨的特征，那么，这与其说是害怕谬误的标志，不如说是害怕真理的标志。谦逊是使我寸步难行的绊脚石。<strong>它就是规定在探讨时要对得出结论感到恐惧</strong>，它是一种对付真理的预防剂。</p>\n<p>其次，真理是普遍的，它不属于我一个人，而为大家所有；真理占有我，而不是我占有真理。我只有构成我的精神个性的形式。“风格如其人。”可是实际情形怎样呢！法律允许我写作，但是不允许我用<strong>自己的</strong>风格去写，我只能用另一种风格去写！我有权利表露自己的精神面貌，但是首先必须使这种面貌具有一种<strong>指定的表情</strong>！哪一个正直的人不为这种无理的要求脸红，而宁愿把自己的脑袋藏到罗马式长袍里去呢？至少可以预料在那长袍下面有一个丘必特的脑袋。指定的表情只不过意味着“强颜欢笑”而已。</p>\n<p>你们赞美大自然令人赏心悦目的千姿百态和无穷无尽的丰富宝藏，你们并不要求玫瑰花散发出和紫罗兰一样的芳香，但你们为什么却要求世界上最丰富的东西——精神只能有<strong>一种</strong>存在形式呢？我是一个幽默的人，可是法律却命令我用严肃的笔调。我是一个豪放不羁的人，可是法律却指定我用谦逊的风格。一片灰色就是这种自由所许可的唯一色彩。每一滴露水在太阳的照耀下者闪现着无穷无尽的色彩。但是精神的太阳，无论它照耀着多少个体，无论它照耀什么事物，却只准产生一种色彩，就是<strong>官方的色彩</strong>！精神的最主要形式是<strong>欢乐、光明</strong>，但你们却要使<strong>阴暗</strong>成为精神的唯一合适的表现；精神只准穿着黑色的衣服，可是花丛中却没有一枝黑色的花朵。精神的实质始终就是<strong>真理本身</strong>，而你们要把什么东西变成精神的实质呢？<strong>谦逊</strong>。歌德说过，只有怯懦者才是谦逊的，你们想把精神变成这样的怯懦者吗？也许，这种谦逊应该是席勒所说的那种天才的谦逊？𨃢是这样的话，那你们就先要把自己的全体公民、特别是你们所有的书报检查官者变成天才。况且天才的谦逊当然不像文雅的语言那样，避免使用乡音和土语，相反，天才的谦逊恰恰在于用事物本身的乡音和表达事物本质的土语来说话。天才的谦逊是要忘掉谦逊和不谦逊，使事物本身突现出来。精神的谦逊总的说来就是理性，就是按照事物的本质特征去对待<strong>各种事物</strong>的那种普遍的思想自由。</p>\n<p>其次，根据特利斯屈兰·善第所下的定义：严肃是肉体为掩盖灵魂缺陷而做出的一种虚伪姿态。如果<strong>严肃</strong>不应当适合这个定义，如果严肃的意思应当是<strong>注重实际</strong>的态度，那么这整个规定就会失去意义。因为我把可笑的事物看成是可笑的，这就是对它采取严肃的态度；对不谦逊仍然采取谦逊的态度，这也就是精神最大的不谦逊。</p>\n<p>严肃和谦逊！这是多么不固定的、相对的概念啊！严肃在哪里结束，诙谐又从哪里开始呢？谦逊在哪里结束，不谦逊又从哪里开始呢？我们的命运不得不由书报检查官的脾气来决定。给书报检查官指定一种脾气和给作者指定一种风格一样，都是错误的。要是你们想在自己的美学批评中表现得彻底，你们就得禁止<strong>过分严肃</strong>和<strong>过分谦逊</strong>去去探讨真理，因为过分的严肃就是最大的滑稽，过分的谦逊就是最辛辣的讽刺。</p>\n<p>最后，这是以对<strong>真理</strong>本身的完全歪曲的和缺角的观点为出发点的。作者的一切活动对象都被归结为“真理”这个一般观念。可是，同一个对象在不同的个人身上会获得不同的反映，并使自已的各个不同方面变成同样多的不同的精神性质；如果我们撇开一切<strong>主观</strong>的东西即上述情况不谈，难道<strong>对象的性质</strong>不应当对探讨发生一些哪怕是最微小的影响吗？不仅探讨的结果应当是合乎真理的，而且得出结果的途径也应当是合乎真理的。对真理的探讨本身应当是真实的，真实的探讨就是扩展了的真理，这种真理的各个分散环节在结果中是相互结合的。难道探讨的方式不应当随着对象而改变吗？当对象欢笑的时候，探讨却应当摆出严肃的样子；当对象令人讨厌的时候，探讨却应当是谦逊的。这样一来，你们就既损害了主体的权利，也损害了客体的权利。你们抽象地理解真理，把精神变成了枯燥地<strong>记录</strong>真理的<strong>裁判官</strong>。<br>也许不必去为这些玄妙的玩意儿伤脑筋？对真理是否干脆就应该这样去理解，即<strong>凡是政府的命令都是真理</strong>，而探讨只不过是一种既多余又麻烦的、可是由于礼节关系又不能完全取消的第三者？看来情况差不多就是如此。因为探讨一开始就被认为是一种同真理对立的东西，因此，它就要在可疑的官方侍从——严肃和谦逊（当然俗人对牧师应该采取这种态度）的伴随下出现。政府的玏是国家的唯一理性；诚然，在一定的时势下，这种理智也必须向另一种理智及其空谈作某些让步，但是到那时，后一种理智就应当意识到：别人已向它让了步，而它西亚是无权的，因此，它应当表现得谦逊而又恭顺，严肃而又乏味的体裁却是独一无二的体裁，只要指出《莱茵省等级会议议论情况》就足以证明这一点。既然如此，为什么不干脆恢复那美好的旧式的德国公文体裁呢？请随意写吧，可是写出来的每一个字都必须同时是对自由的书报检查机关的阿谀奉承之词，而书报检查机关也就会让你们那既严肃又谦逊的言论顺利通过。可千万不要失去虔敬的意识啊！<br><strong>法律强调</strong>的并不是真理，而是谦逊和严肃。因此，一切——严肃，谦逊，首先是真理，都会引起怀疑，因为在这种真理的不确定的范围背后，看来还隐藏着一种非常确定、非常可疑的真理。检查令接着指出：</p>\n<p>“因此，论如何不应该按照某种心胸狭隘的、超出这一法律界限的意旨来实行书报检查。”</p>\n<p>“<strong>这一法律</strong>”首先指的就是 1819 年法令的第 2 条，可是检查令接着又援引了这个书报检查法令的总的“<strong>精神</strong>”。要把上面的两种规定结合起来是得容易的，因为书报检查法令的第2条就是该法令的<strong>精神的集中体现</strong>，而它的其余各条则是这种精神的更具体的划分和更详尽的规定。我们认为，对<strong>上述精神的以下几种表述</strong>最能说明这种精神的特征：</p>\n<p>第 7 条：“<strong>科学院与各大学到目前为止所享有的免受书报检查的自由，在今后五年内将被取消。”<br>第 10 款：“</strong>本临时决议<strong>自即日起生效，有效期五年，期满之前，联邦议会应切实研究通过体积办法才能够实施联邦条例第 18 条中</strong>提出的有关新闻出版自由<strong>的各项统一规定。随后就应该对德国境内</strong>新闻出版自由<strong>的合法</strong>界限**作出最后决定。”</p>\n<p>有这样一种法律，哪里还存在<strong>新闻出版自由</strong>，它就取消这种自由，哪里应当实行新闻出版自由，它就通过<strong>书报检查</strong>使这种自由变成多余的东西——这样的法律不能认为是有利于新闻出版的。上述的第 10 款也干脆承认，暂时用<strong>书报检查法</strong>来代替联邦条例第18条中提出的、可能有一天要实行的<strong>新闻出版自由</strong>。这种quid pro quo［移花接木］[4]的做法至少表明，时势要求对新闻出版加以限制，法令就是由于不信任新闻出版界而产生的。为了替这种不得人心的做法辩解，甚至硬说这是一项有效期限只有五年的临时措施，可查，遗憾得很，它的有效期限竟达 22 年之久。</p>\n<p>从检查令的下面一句话中我们就可以看出，检查令是如何陷于自相矛盾的，它一方面不允许按照超出法令界限的意旨来实行书报检查，但另一方面又规定书报检查应当超出这种界限：“当然，书报检查官也可以允许人们坦率地讨论国内事务。”书报检查官<strong>可以</strong>这样做，但不一定要这样做，因为这不是非做不可的。仅仅这种慎重的自由主义就已经非常肯定地不仅超出了书报检查法令的精神，而且也超出了它的特定要求。旧的书报检查法令，即在检查令中引用的第 2 条，不仅不准<strong>坦率地讨论</strong>普鲁士的事务，甚至也不准<strong>坦率地讨论中国</strong>的事务。检查令这样解释：“凡对<strong>任何国家中</strong>存在的图谋推翻国家制度的政党作赞许的叙述的一切企图，均属于这一范围”，即属于破坏普鲁士邦和德意志联邦 46 其他各邦的安全的范围。在这种情况下，难道还允许对中国或土耳其的国内事务进行<strong>坦率</strong>的讨论吗？既然如此遥远的情况都威胁着德意志联邦的脆弱的安全，那么每一句对内部事务表示不满的话又怎能不威胁它的安全呢？</p>\n<p>这样一来，检查令在自由主义方面就超出了书报检查法令第 2 条的精神（超出的<strong>内容</strong>以后就会清楚，不过，既然这种超出被说成是法令第 2 条的结论，那它<strong>在形式上</strong>就是值得怀疑的，其实检查令只明智地引用了法令第 2 条的<strong>前一半</strong>，但又责成书报检查官按照第 2 条<strong>条文本身</strong>办事），而在<strong>非自由主义方面</strong>，检查令也同样超出了<strong>书报检查法令</strong>的范围，它在对<strong>报刊</strong>的旧有的<strong>限制</strong>之外又加上了<strong>新</strong>的限制。</p>\n<p>上述书报检查法令的第 2 条指出：</p>\n<p>“它的〈书报检查的〉目的是：与<strong>宗教的一般原则</strong>相违背的一切均应杜绝，<strong>不管个别</strong>宗教党派和国内允许存在的教派的见解和教义<strong>如何</strong>。”</p>\n<p>1819 年，理性主义还占统治地位，这种理论把一般的宗教理解为所谓理性的宗教。这种<strong>理性主义的观点</strong>也就是书报检查法令的观点，可是这个法令太不彻底，它的目的是要保护宗教，但它的观点却是反宗教的。这种把宗教的一般原则同它的实际内容和规定性分割开来的做法，正是同宗教的一般原则相抵触的。因为每种宗教都认为，它同其他各种特殊的、<strong>虚构</strong>的宗教的区别，正在于它的<strong>特殊本质</strong>，正是由于它有这种<strong>规定性</strong>，它才是<strong>真正的宗教</strong>。新的书报检查令在它引用的第 2 条中省略了<strong>附加的限制条文</strong>，根据这一条文的规定，个别宗教党派和教派都不享有神圣不可侵犯的权利。不仅如此，检查令还作了如下的解释：</p>\n<p>“凡以<strong>轻佻的、敌对的</strong>方式反对一般的<strong>基督</strong>教或<strong>某一教理</strong>的行为，均不应容忍。”</p>\n<p>旧的书报检查法令绝口不谈<strong>基督</strong>教，相反，它把宗教同所有个别的宗教党派和教派区别开来。新的书报检查令则不仅把宗教改成了<strong>基督</strong>教，而且还加上了<strong>某一教理</strong>几个字。这就是我们那种已经基督教化的科学的滑稽产物！新的书报检查令又给新闻出版造好了新的枷锁，谁还能否认这一点呢？据说，既不能<strong>一般地</strong>反对宗教，也不能<strong>特殊地</strong>反对宗教。或者，你们也许以为，“<strong>轻佻的、敌对的</strong>”这几个字眼已使新的锁链变成了玫瑰花环吧？轻佻、敌对，说得多么巧妙啊！“轻佻的”这个形容词是要求公民行为端庄正派，这是一个对众人公开的字眼，“敌对的”这个形容词则是对书报检查官偷偷地说的，它是“轻佻”在法律上的解释。在检查令中我们还能找到许多玩弄这种巧妙手法的例子：对公众用的是一套主观的、使人面红耳赤的字眼，对书报检查官用的则是另一套客观的、使作者不禁脸色发白的字眼。lettres de cachet［盖有封印的上谕］[5]简直也可以用这种手法谱成乐曲了。</p>\n<p>书报检查令陷入了多么令人惊奇的矛盾！只有那种不彻底的攻击才是轻佻的，这种攻击只针对现象的个别方面，由于它本身不够深刻和严肃，因而不能涉及事物的本质；正是<strong>仅仅对特殊事物</strong>本身的攻击，才是轻佻的。因此，如果禁止对一般基督教的攻击，那么，只有对它的轻佻的攻击才是许可的了。相反，对宗教的一般原则，对宗教的本质，以及对特殊事物（<strong>就它是</strong>本质的<strong>表现</strong>而言）的攻击，都是敌对的。攻击宗教只能采取<strong>轻佻的或者敌对的</strong>方式，第三种方式是不存在的。当然，检查令的这种不彻底性只是一种假象，因为这种不彻底性的立足点就是这样一种<strong>假象</strong>而已。对于宗教，既不能用敌对的方式去攻击，也不能用轻佻的方式去攻击，既不能一般地去攻击，也不能特殊地去攻击，这就是说，<strong>根本不许</strong>攻击。</p>\n<p>可是，如果同 1819 年的书报检查法令有明显矛盾的检查令要给<strong>哲学方面的书刊</strong>带上新的枷锁，那它至少应当表现得得彻底，能使<strong>宗教方面的书刊</strong>摆脱以前理性主义的法令加在它身上的旧枷锁。因为该法令曾宣布书报检查的目的也是“反对把宗教信条狂热地搬到政治中去，防止由此引起的<strong>概念混乱</strong>”。</p>\n",
            "tags": [
                "中文马克思主义文库"
            ]
        },
        {
            "id": "https://utgnim.github.io/%E9%9D%92%E5%B9%B4%E5%9C%A8%E9%80%89%E6%8B%A9%E8%81%8C%E4%B8%9A%E6%97%B6%E7%9A%84%E8%80%83%E8%99%91/",
            "url": "https://utgnim.github.io/%E9%9D%92%E5%B9%B4%E5%9C%A8%E9%80%89%E6%8B%A9%E8%81%8C%E4%B8%9A%E6%97%B6%E7%9A%84%E8%80%83%E8%99%91/",
            "title": "青年在选择职业时的考虑",
            "date_published": "2025-09-14T05:08:44.000Z",
            "content_html": "<p><strong>『卡·马克思的中学考试德语作文』</strong></p>\n<p>自然本身给动物规定了它应该遵守的活动范围，动物也就安分地在这个范围内活动，而不试图越出这个范围，甚至不考虑有其它满园存在。神也给人指定了共同的目标——使人类和他自己趋于高尚，但是，神要人自己去寻找可以达到这个目标的手段；神让人在社会上选择一个最适合于他、最能使他和社会变得高尚的地位。</p>\n<p>这种选择是人比其它创造物远为优越的地方，但同时也是可能毁灭人的一生、破坏他的一切计划并使他陷于不幸的行为。因此，认真地权衡这种选择，无疑是开始走上生活道路而又不愿在最重要的事情上听天由命的青年的首要责任。</p>\n<p>每个人眼前都有一个目标，这个目标至少在他本人看来是伟大的，而且如果最深刻的信念，即内心深处的声音，认为这个目标是伟大的，那它实际上也是伟大的，因为神决不会使世人完全没有引导者；神轻声地但坚定地作启示。</p>\n<p>但是，这声音很容易被淹没；我们认为是热情的东西可能倏忽而生，同样可能倏忽而逝。也许，我们的幻想蓦然迸发，我们的感情激动起来，我们的眼前浮想联翩，我们狂热地追求我们以为是神本身给我们指出的目标；但是，我们梦寐以求的东西很快就使我们厌恶，于是，我们便感到自己的整个存在遭到了毁灭。</p>\n<p>因此，我们应当认真考虑：我们对所选择的职业是不是真的怀有热情？发自我们内心的声音是不是同意选择这种职业？我们的热情是不是一种迷误？我们认为是神的召唤的东西是不是一种自我欺骗？不过，如果不对热情的来源本身加以探究，我们又怎么能认清这一切呢？</p>\n<p>伟大的东西是闪光的，闪光会激发虚荣心，虚荣心容易使人产生热情 或者一种我们觉得是热情的东西；但是，被名利迷住了心窍的人，理性是无法加以约束的，于是他一头栽达那不可抗拒的欲念召唤他去的地方；，他的职业已经不再是由他自己选择，而是由偶然机会和假象去决定了。</p>\n<p>我们的使命决不是求得一个最足以炫耀的职业，因为它不是那种可能由我们长期从事，但始终不会使我们感到厌倦、始终不会使我们劲头低落、始终不会使我们的热情冷却的职业，相反，我们很快就会觉得，我们的愿望没有得到满足，我们的理想没有实现，我们就将怨天尤人。</p>\n<p>但是，不仅虚荣心能够引起对某种职业的突然的热情，而且我们也许会用自己的幻想把这种职业美化，把它美化成生活所能提供的至高无上的东西。我们没有仔细分析它，没有衡量它的全部分量，即它加在我们肩上的重大责任；我们只是从远处观察它，而从远处观察是靠不住的。</p>\n<p>在这里，我们自己的理性不能给我们充当顾问，因为当它被感情欺骗，受幻想蒙蔽时，它既不依靠经验，也不依靠更深入的观察。然而，我们的目光应该投向谁呢？当我们丧失理性的时候，谁来支持我们呢？</p>\n<p>是我们的父母，他们走过了漫长的生活道路，饱尝了人世辛酸。——我们的心这样提醒我们。</p>\n<p>如果我们经过冷静的考察，认清了所选择的职业的全部分量，了解它的困难以后，仍然对它充满热情，仍然爱它，觉得自己适合于它，那时我们就可以选择它，那时我们既不会受热情的欺骗，也不会仓促从事。</p>\n<p>但是，我们并不问题能够选择我们自认为适合的职业；我们在社会上的关系，还在我们有能力决定它们以前就已经在某种程度上开始确立了。</p>\n<p>我们的体质常常威胁我们，可是任何人也不敢藐视它的权利。</p>\n<p>诚然，我们能够超越体质的限制，但这么一来，我们也就垮得更快；在这种情况下，我们就是冒险把大厦建筑在残破的废墟上，我们的一生也就变成一场精神原则和肉体原则之间的不幸的斗争。但是，一个不能克服自身相互斗争的因素的人，又怎能抗御生活的猛烈冲击，怎能安静地从事活动呢？然而只有从安静中才能产生出伟大壮丽的事业，安静是唯一能生长出成熟果实的土壤。</p>\n<p>尽管我们由于体质不适合我们的职业，不能持久地工作，而且很少能够愉快地工作，但是，为了克尽职守而牺牲自己幸福的思想激励着我们不顾体弱去努力工作。如果我们选择了力不胜任的职业，那么我们决不能把它做好，我们很快就会自愧无能，就会感到自己是无用的人，是不能完成自己使命的社会成员。由此产生的最自然的结果就是自卑。还有比这更痛苦的感情吗？还有比这更难于靠外界的各种赐予来补偿的感情吗？自卑是一条毒蛇，它无尽无休地搅扰、啃啮我们的胸膛，吮吸我们心中滋润生命的血液，流入厌世和绝望的毒液。</p>\n<p>如果我们错误地估计了自己的能力，以为能够胜任经过较为仔细的考虑而选定的职业，那么这种错误将使我们受到惩罚。即便不受到外界的指责，我们也会感到比外界指责更为可怕的痛苦。</p>\n<p>如果我们把这一切都考虑过了，如果我们的生活条件容许我们选择任何一种职业，那么我们就可以选择一种使我们获得最高尊严的职业，一种建立在我们深信其正确的思想上的职业，一种能给我们提供最广阔的场所来为人类工作，并使我们自己不断接近共同目标即臻于完美境界的职业，而对于这个共同目标来说，任何职业都只不过是一种手段。</p>\n<p>尊严是最能使人高尚、使他的活动和他的一切努力具有更加崇高品质的东西，是使他无可非议、受到众人钦佩并高出于众人之上的东西。</p>\n<p>但是，能给人以尊严的只有这样的职业，在从事这种职业时我们不是作为奴隶般的工具，而是在自己的领域内独立地进行创造；这种职业不需要有不体面的行动（哪怕只是表面上不体面的行动），甚至最优秀的人物也会怀着崇高的自豪感去从事它。最合乎这些要求的职业，并不总是最高的职业，但往往是最可取的职业。</p>\n<p>但是，正如有失尊严的职业会𩨧我们一样，那种建立在我们后来认为是错误的思想上的职业也一定会成为我们的沉重负担。</p>\n<p>这里，我们除了自我欺骗，别无解救办法，而让人自我欺骗的解救办法是多么令人失望啊！</p>\n<p>那些主要不是干预生活本身，而是从事抽象真理的研究的职业，对于还没有确立坚定的原则和牢固的、不可动摇信念的青年是最危险的，当然，如果这些职业在我们心里深深地扎下了根，如果我们能够为它们的主导思想而牺牲生命、竭尽全力，这些职业看来还是最高尚的。</p>\n<p>这些职业能够使具有合适才干的人幸福，但是也会使那些不经考虑、凭一时冲动而贸然从事的人毁灭。</p>\n<p>相反，重视作为我们职业的基础的思想，会使我们在社会上占有较高的地位，提高我们自己的尊严，使我们的行为不可动摇。</p>\n<p>一个选择了自己所珍视的职业的人，一想到他可能不称职时就会战战兢兢——这种人单是因为他在社会上所处的地位是高尚的，他也就会使自己的行为保持高尚。</p>\n<p>在选择职业是，我们应该遵守的主要指针是人类的幸福和我们自身的完美。不应认为，这两种利益会彼此敌对、互相冲突，一种利益必定消灭另一种利益；相反，人的本性是这样的：人只有为同时代人的完美、为他们的幸福而工作，自己才能达到完美。</p>\n<p>如果一个人只为自己劳动，他也话能够成为著名的学者、伟大的哲人、卓越的诗人，然而他永远不能成为完美的、真正伟大的人物。</p>\n<p>历史把那些为共同目标工作因而自己高尚的人称为最伟大的人物；经验赞美那些为大多数人带来幸福的人是最幸福的人；宗教本身也教诲我们，人人敬仰的典范，就曾为人类而牺牲自己——有谁敢否定这类教诲呢？</p>\n<p>如果我们选择了最能为人类而工作的职业，那么我们所享受的就不是可怜的、有限的、自私的乐趣，我们的幸福将属于千百万人，我们的事业将悄然无声地存在下去，但是它会永远发挥作用，而面对我们的骨灰，高尚的人们将洒下热泪。</p>\n<p align=\"right\">卡·马克思写于 1835 年 8 月</p>\n",
            "tags": [
                "中文马克思主义文库"
            ]
        },
        {
            "id": "https://utgnim.github.io/%E2%80%9C%E5%8F%A4%E6%96%87%E8%A7%82%E6%AD%A2%E2%80%9D/",
            "url": "https://utgnim.github.io/%E2%80%9C%E5%8F%A4%E6%96%87%E8%A7%82%E6%AD%A2%E2%80%9D/",
            "title": "“古文观止”",
            "date_published": "2025-08-04T11:58:52.000Z",
            "content_html": "<h4 id=\"劝学\"><a href=\"#劝学\" class=\"headerlink\" title=\"劝学\"></a>劝学</h4><p>荀子『先秦』</p>\n<p>君子曰：学不可以已。</p>\n<p>青，取之于蓝，而青于蓝；冰，水为之，而寒于水。木直中绳，𫐓以为轮，其曲中规。虽有槁暴，不利挺者，𫐓使之然也。故木受绳同时直，金就砺则利，君子博学而日参省乎己，则知明而行无过矣。</p>\n<p>故不登高山，不知天之高也；不临深溪，不知地之厚也；不闻先王之遗言，不知学问之大也。干、越、夷、貉之子，生而同声，长而异俗，教使之然也。诗曰：“嗟尔君子，无恒安息。靖共尔位，好是正直。神之听之，介尔景福。”神莫大于化道，福莫长于无祸。</p>\n<p>吾尝终日而思矣，不如须臾之所学也；吾尝跂而望矣，不如登高之博见也。登高而招，臂非加长也，而见者远；顺风而呼，声非加疾也，而闻者彰。假舆马者，非利足也，而致千里；假舟楫者，非能水也，而绝江河。君子生非异也，善假于物也。</p>\n<p>南方有鸟焉，名曰蒙鸠，以羽为巢，而编之以发，系之苇苕，风至苕折，卵破子死。巢非不完也，所系者然也。西方有木焉，名曰射干，茎长四寸，生于高山之上，而临百仞之渊，木茎非能长也，所立者然也。蓬生麻中，不扶而直；白沙在涅，与之俱黑。兰槐之根是为芷，其渐之滫，君子不近，庶人不服。其质非不美也，所渐者然也。故君子居必择乡，游必就土，所以防邪辟而近中正也。</p>\n<p>物类之起，必有所始。荣辱之来，必象其德。肉腐出虫，鱼枯生蠹。怠慢忘睡，祸灾乃作。强自取柱，柔自取束。邪秽在身，怨之所构。施薪若一，火就燥也，平地若一，水就湿也。草木畴生，禽兽君焉，物各从其类也。是故质的张，而弓矢至焉；林木茂，而斧斤至焉；树成荫，而众鸟息焉。醯酸，而蜹聚焉。故言有招祸也，行有招辱也，君子慎其所立乎！</p>\n<p>积土成山，风雨兴焉；积水成渊，蛟龙生焉；积善成德，而神明自得，圣心备焉。故不积跬步，无以至千里；不积小流，无以成江海。骐骥一跃，不能十步；驽马十驾，功在不舍。锲而舍之，朽木不折；锲而不舍，金石可镂。蚓无爪牙之利，筋骨之强，上食埃土，下饮黄泉，用心一也。蟹六跪而二螯，非蛇鳝之穴无可寄托者，用心躁也。（江海 一作：江河）</p>\n<p>是故无冥冥之志者，无昭昭之明；无惛惛之事者，无赫赫之功。行衢道者不至，事两君者不容。目不能两视而明，耳不能两听而聪。螣蛇无足而飞，鼫鼠五技而穷。《诗》曰：“尸鸠在桑，其子七兮。淑人君子，其仪一兮。其仪一兮，心如结兮！”故君子结于一也。</p>\n<p>昔者瓠巴鼓瑟，而流鱼出听；伯雅鼓琴，而六马仰秣。故声无小而不闻，行无隐而不形。玉在山而草木润，渊生珠而崖不枯。为善不积邪？安有不闻者乎？</p>\n<p>学恶乎始？恶乎终？曰：其数则始乎诵经，终乎读礼；其义则始乎为士，终乎为圣人，真积力久则入，学至乎没而后止也。故学数有终，若其义则不可须臾舍也。为之，人也；舍之，禽兽也。故书者，政事之纪也；诗者，中声之所止也；礼者，法之大分，类之纲纪也；故；学至乎礼而止矣。夫是之谓道德之极。礼之敬文也，乐之中和也，诗书之博也，春秋之微也，在天地之间者毕矣。</p>\n<p>君子之学也，入乎耳，箸乎心，布乎四体，形乎动静。端而言，蝡而动，一可以为法则。小人之学也，入乎耳，出乎口；口耳之间，则四寸耳，曷足以美七尺之躯哉！古之学者为己，今之学者为人。君子之学也，以美其身；小人之学也，以为禽犊。故不问而告谓之傲，问一而告二谓之囋。傲非也，囋非也；君子如向矣。</p>\n<p>学莫便乎近其人。礼乐法而不说，诗书故而不切，春秋约而不速。方其人之习君子之说，则尊以遍矣，周于世矣。故曰：学莫便乎近其人。</p>\n<p>学之经莫速乎好其人，隆礼次之。上不能好其人，下不能隆礼，安特将学杂识志，顺诗书而已耳。则末世穷年，不免为陋儒而已。将原先王，本仁义，则礼正其经纬蹊径也。若挈裘领，诎五指而顿之，顺者不可胜数也。不道礼宪，以诗书为之，譬之犹以指测河也，以戈春黍也，以锥餐壶也，不可以得之矣。故隆礼，虽未明，法士也；不隆礼，虽察辩，散儒也。</p>\n<p>问楛者，勿告也；告楛者，勿问也；说楛者，勿听也。有争气者，勿与辩也。故必由其道至，然后接之；非其道则避之。故礼恭，而后可与言道之方；辞顺，而后感与言道之理；色从而后可与言道之致。故未可与言而言，谓之傲；可与言而不言，谓之隐；不观气色而言，谓瞽。故君子不傲、不隐、不瞽，谨顺其身。诗曰：“匪交匪舒，天子所予。”此之谓也。</p>\n<p>百发失一，不足谓善射；千里蹞步一至，不足谓善御；伦类一通，仁义不一，不足谓善学。学也者，固学一之也。一出焉，一入焉，涂巷之人也；其善者少，不善者多，桀纣盗跖也；全之尽之，然后学者也。</p>\n<p>君子知夫不全不粹之不足以为美也，故诵数以贯之，思索以通之，为其人以处之，除其害者以持养之。使目非是无欲见也，使耳非是无欲闻也，使口非是无欲言也，使心非是无欲虑也。及至其致好之也，目好之五色，耳好之五声，口好之五味，心利之有天下。是故权利不能倾也，群众不能移也，天下不能荡也，生乎由是，死乎由是，夫是之谓德操。德操然后能定，能定然后能应。能写能应，夫是之谓成人。天见其明，地见其光，君子贵其全也。</p>\n",
            "tags": [
                "抄书",
                "练字"
            ]
        },
        {
            "id": "https://utgnim.github.io/%E6%B5%AE%E7%94%9F%E5%85%AD%E8%AE%B0-%E5%8D%B7%E4%B8%80-%E9%97%BA%E6%88%BF%E8%AE%B0%E4%B9%90-%E4%BA%8C%E5%8D%81%E4%B8%80/",
            "url": "https://utgnim.github.io/%E6%B5%AE%E7%94%9F%E5%85%AD%E8%AE%B0-%E5%8D%B7%E4%B8%80-%E9%97%BA%E6%88%BF%E8%AE%B0%E4%B9%90-%E4%BA%8C%E5%8D%81%E4%B8%80/",
            "title": "浮生六记 - 卷一 闺房记乐 二十一",
            "date_published": "2025-07-30T13:35:49.000Z",
            "content_html": "<p>邻仅老夫妇二人，灌园为业，知余夫妇避暑于此，先来通殷勤，并钓池鱼、摘园蔬为馈。偿其价，不受。芸作鞋报之，始谢而受。</p>\n<p>时方七月，绿树阴浓，水面风来，蝉鸣聒耳。</p>\n<p>邻老又为制鱼竿，与芸垂钓于柳阴深处。日落时，登土山，观晚霞夕照，随意联吟，有“兽云吞落日，弓月弹流星”之句。少焉，月印池中，虫声四起，设竹榻于篱下，老妪报酒温饭熟，遂就月光对酌，微醺而饭。浴罢，则凉鞋蕉扇，或坐或卧，听邻老谈因果报应事。三鼓归卧，周体清凉，几不知身居城市矣。</p>\n<p>篱边倩邻老购菊，遍植之。九月花开，又与芸居十日。吾母亦欣然来观，持螯对菊，赏玩竟日。</p>\n<p>芸喜曰：“他年当与君卜筑于此，买绕屋菜园十亩，课仆妪，植瓜蔬，以供薪水。君画我绣，以为诗酒之需。布衣菜饭，可乐终身，不必作远游计也。”</p>\n<p>余深然之。今即得有境地，而知己沦亡，可胜浩叹！</p>\n",
            "tags": [
                "抄书",
                "练字"
            ]
        },
        {
            "id": "https://utgnim.github.io/%E6%B5%AE%E7%94%9F%E5%85%AD%E8%AE%B0-%E5%8D%B7%E4%B8%80-%E9%97%BA%E6%88%BF%E8%AE%B0%E4%B9%90-%E4%BA%8C%E5%8D%81/",
            "url": "https://utgnim.github.io/%E6%B5%AE%E7%94%9F%E5%85%AD%E8%AE%B0-%E5%8D%B7%E4%B8%80-%E9%97%BA%E6%88%BF%E8%AE%B0%E4%B9%90-%E4%BA%8C%E5%8D%81/",
            "title": "浮生六记 - 卷一 闺房记乐 二十",
            "date_published": "2025-07-30T13:18:12.000Z",
            "content_html": "<p>迁仓米巷，余颜其卧楼曰“宾香阁”，盖以芸名而取“如宾”之意也。</p>\n<p>院窄墙高，一无可取。后有厢楼，通藏书处，开窗以陆氏废园，但有荒凉之象。沧浪风景，时切芸怀。</p>\n<p>有老妪居金母桥之东，埂巷之北。绕屋皆菜圃，编篱为门，门外有池，约亩许，花光树影，错杂篱边。其地即元末张士诚王府废基也。屋西数武，瓦砾堆土成山，登其巅可远眺。地旷人稀，颇饶野趣。</p>\n<p>妪偶言及，芸神往不置，谓余曰：“自别沧浪，梦魂常绕，今不得已而思其次，其老妪之居乎？”</p>\n<p>余曰：“连朝秋暑灼人，正思得一清凉地以消长昼。卿若愿往，我先观其家，可居，即襆被而往，作一月盘桓，何如？”</p>\n<p>芸曰：“恐堂上不许。”</p>\n<p>余曰：“我自请之。”</p>\n<p>越日，至其地，屋仅二间，前后隔而为四，纸窗竹榻，颇有幽趣。老妪知其意，欣然出其卧室为赁，四壁糊以白纸，顿觉改观。于是禀知吾母，挈芸居焉。</p>\n",
            "tags": [
                "抄书",
                "练字"
            ]
        },
        {
            "id": "https://utgnim.github.io/%E6%B5%AE%E7%94%9F%E5%85%AD%E8%AE%B0-%E5%8D%B7%E4%B8%80-%E9%97%BA%E6%88%BF%E8%AE%B0%E4%B9%90-%E6%8B%BE%E7%8E%96/",
            "url": "https://utgnim.github.io/%E6%B5%AE%E7%94%9F%E5%85%AD%E8%AE%B0-%E5%8D%B7%E4%B8%80-%E9%97%BA%E6%88%BF%E8%AE%B0%E4%B9%90-%E6%8B%BE%E7%8E%96/",
            "title": "浮生六记 - 卷一 闺房记乐 拾玖",
            "date_published": "2025-07-29T14:04:27.000Z",
            "content_html": "<p>其癖好与余同，且能察眼意，懂眉语，一举一动，示之以色，无不头头是道。</p>\n<p>余尝曰：“惜卿雌而伏，苟能化女为男，相与访名山，搜胜迹，遨游天下，不亦快哉！”</p>\n<p>芸曰：“此何难，俟妾鬓斑之后，虽不能远游五岳，而近地之虎阜、灵岩，南至西湖，北至平山，尽可偕游。”</p>\n<p>余曰：“恐卿鬓斑之日，步履已艰。”</p>\n<p>芸曰：“今世不能，期以来世。”</p>\n<p>余曰：“来世卿当作男，我为女子相从。”</p>\n<p>芸曰：“必得不昧今生，方觉其有情趣。”</p>\n<p>余笑曰：“幼时一粥，犹谈不了，若来世不昧今生，合卺之夕，细谈隔世，更无合眼时矣。”</p>\n<p>芸曰：“世传月下老人专司人间婚姻事，今生夫妇已承牵合，来世婚姻亦须仰籍神力，盍绘一像祀之？”</p>\n<p>时有苕溪戚柳堤，名遵善写人物。倩绘一像：一手挽红丝，一手携杖，悬姻缘簿，童颜鹤发，奔驰于非烟非雾中。此戚君得意笔也。友人石琢堂为题赞语于首。悬之内室。</p>\n<p>每逢朔望，余夫妇必焚香拜祷。后因家庭多故，此画竟失所在，不知落在谁家矣。</p>\n<p>“他生未卜此生休”，两人痴情，果邀神鉴耶？</p>\n",
            "tags": [
                "抄书",
                "练字"
            ]
        },
        {
            "id": "https://utgnim.github.io/%E6%B5%AE%E7%94%9F%E5%85%AD%E8%AE%B0-%E5%8D%B7%E4%B8%80-%E9%97%BA%E6%88%BF%E8%AE%B0%E4%B9%90-%E6%8B%BE%E6%8D%8C/",
            "url": "https://utgnim.github.io/%E6%B5%AE%E7%94%9F%E5%85%AD%E8%AE%B0-%E5%8D%B7%E4%B8%80-%E9%97%BA%E6%88%BF%E8%AE%B0%E4%B9%90-%E6%8B%BE%E6%8D%8C/",
            "title": "浮生六记 - 卷一 闺房记乐 拾捌",
            "date_published": "2025-07-29T13:49:49.000Z",
            "content_html": "<p>余启堂弟妇，王虚舟先生孙女也。催妆时偶缺珠花，芸出其纳采所受者呈吾母，婢妪旁惜之。</p>\n<p>芸曰：“凡为妇人，已属纯阴，珠乃纯阴之精，用为首饰，阳气全克矣，何贵焉？”</p>\n<p>而于破书残画，反极珍惜。书之残缺不全者，必搜集分门，汇订成帙，统名之曰：“断简残编”；字画之破损者，必觅故纸，粘补成幅，有破缺处，倩予全好而卷之，名曰“弃余集赏”。于女红中馈之暇，终日琐琐，不惮烦倦。</p>\n<p>芸于破笥烂卷中，偶获片纸可观者，如得异宝。旧邻冯妪每收乱卷卖之。</p>\n",
            "tags": [
                "抄书",
                "练字"
            ]
        },
        {
            "id": "https://utgnim.github.io/%E6%B5%AE%E7%94%9F%E5%85%AD%E8%AE%B0-%E5%8D%B7%E4%B8%80-%E9%97%BA%E6%88%BF%E8%AE%B0%E4%B9%90-%E6%8B%BE%E6%9F%92/",
            "url": "https://utgnim.github.io/%E6%B5%AE%E7%94%9F%E5%85%AD%E8%AE%B0-%E5%8D%B7%E4%B8%80-%E9%97%BA%E6%88%BF%E8%AE%B0%E4%B9%90-%E6%8B%BE%E6%9F%92/",
            "title": "浮生六记 - 卷一 闺房记乐 拾柒",
            "date_published": "2025-07-28T14:55:54.000Z",
            "content_html": "<p>芸初缄默，喜听余议论。余调其言，如蟋蟀之用纤草，渐能发议。</p>\n<p>其每日饭必用茶泡，喜用茶泡食芥卤乳腐，吴俗呼为“臭乳腐”，又喜食虾卤瓜。此二物余生平所最恶者，因戏之曰：“狗无胃而食粪，以其不知臭秽；蜣螂团粪而化蝉，以其欲修高举也。卿其狗耶？蝉耶？”</p>\n<p>芸曰：“腐取其价廉而可粥可饭，幼时食惯。今至君家，已如蜣螂化蝉，犹喜食之者，不忘本也。至卤瓜之味，到此初尝耳。”</p>\n<p>余曰：“然则我家系狗窦耶？”</p>\n<p>芸窘而强解曰：“夫粪，人家皆有之，要在食与不食之别耳。然君喜食蒜，妾亦强啖之。腐不敢强，瓜可掩鼻略尝，入咽当知其美，此犹无盐貌丑而德美也。”</p>\n<p>余笑曰：“卿陷我作狗耶？”</p>\n<p>芸曰：“妾作狗久矣，屈君试尝之。”</p>\n<p>以箸强塞余口。余掩鼻咀嚼之，似觉脆美，开鼻再嚼，竟成异味，从此亦喜食。</p>\n<p>芸以麻油加白糖少许拌卤腐，亦鲜美。以卤瓜捣烂拌卤腐，名之曰“双鲜酱”，有异味。</p>\n<p>余曰：“始恶而终好之，理之不可解也。”</p>\n<p>芸曰：“情之所钟，虽丑不嫌。”</p>\n",
            "tags": [
                "抄书",
                "练字"
            ]
        },
        {
            "id": "https://utgnim.github.io/%E6%B5%AE%E7%94%9F%E5%85%AD%E8%AE%B0-%E5%8D%B7%E4%B8%80-%E9%97%BA%E6%88%BF%E8%AE%B0%E4%B9%90-%E6%8B%BE%E5%85%AD/",
            "url": "https://utgnim.github.io/%E6%B5%AE%E7%94%9F%E5%85%AD%E8%AE%B0-%E5%8D%B7%E4%B8%80-%E9%97%BA%E6%88%BF%E8%AE%B0%E4%B9%90-%E6%8B%BE%E5%85%AD/",
            "title": "浮生六记 - 卷一 闺房记乐 拾六",
            "date_published": "2025-07-19T16:23:37.000Z",
            "content_html": "<p>余堂伯父素存公早亡，无后，吾父以余嗣焉。墓在西跨塘福寿山祖茔之侧，每年春日，必挈芸拜扫。王二姑闻其地有戈园之胜，请同往。</p>\n<p>芸见地下小乱石有苔纹，斑驳可观，指示余日：“以此叠盆山，较宣州白石为古致。”</p>\n<p>余曰：“若此者，恐难多得。”</p>\n<p>王曰：“嫂果爱此，我为拾之。”</p>\n<p>即向守坟者麻袋一，鹤步而拾之。每得一块，余曰“善”，即收之；余曰“否”，即去之。未几，粉汗盈盈，拽袋返曰：“再拾则力不胜矣。”</p>\n<p>芸且拣且言曰：“我闻山果收获，必代猴力，果然。”</p>\n<p>王愤撮十指作哈痒状，余横阻之，责芸曰：“人劳汝逸，犹作此语，无怪妹之动愤也。”</p>\n<p>归途游戈园，稚绿娇红，争妍竞媚。王素憨，逢花必折。芸叱曰：“既无瓶养，又不簪戴，多折何为？”</p>\n<p>王曰：“不知痛痒者，何害？”</p>\n<p>余笑曰：“将来罚嫁麻面多须郎，为花泄忿。”</p>\n<p>王恕余以目，掷花于地，以莲钩拨入池中，曰：“何欺侮我之甚也！”</p>\n<p>芸笑解之而罢。</p>\n",
            "tags": [
                "抄书",
                "练字"
            ]
        },
        {
            "id": "https://utgnim.github.io/%E6%B5%AE%E7%94%9F%E5%85%AD%E8%AE%B0-%E5%8D%B7%E4%B8%80-%E9%97%BA%E6%88%BF%E8%AE%B0%E4%B9%90-%E6%8B%BE%E4%BA%94/",
            "url": "https://utgnim.github.io/%E6%B5%AE%E7%94%9F%E5%85%AD%E8%AE%B0-%E5%8D%B7%E4%B8%80-%E9%97%BA%E6%88%BF%E8%AE%B0%E4%B9%90-%E6%8B%BE%E4%BA%94/",
            "title": "浮生六记 - 卷一 闺房记乐 拾五",
            "date_published": "2025-07-19T16:06:35.000Z",
            "content_html": "<p>吾父稼夫公喜认义子，以故余异姓弟兄有二十六人。吾母亦有义女九人，九人中王二姑、俞六姑与芸最和好。王痴憨善饮，俞豪爽善谈。每集必逐余居外，而得三女同榻，此俞六姑一人计也。</p>\n<p>余笑曰：“俟妹于归后，我当邀妹丈来，一住必十日。”</p>\n<p>俞曰：“我亦来此，与嫂同榻，不大妙耶？”</p>\n<p>芸与王微笑而已。</p>\n<p>时为吾北启堂娶妇，迁居饮马桥之仓米巷。屋虽宏畅，非复沧浪亭之幽雅矣。吾母诞辰演剧，芸初以为奇观。吾父素无忌讳，点演《惨别》等剧，老伶刻画，见者情动。</p>\n<p>余窥帘，见芸忽起去，良久不出，入内探之，俞与王亦继至。见芸一人支颐独坐镜奁之侧，余曰：“何不快乃尔？”芸曰：“观剧原以陶情，今日之戏徒令人断肠耳。”俞与王皆笑之。余曰：“此深于情者也。”俞曰：“嫂将竟日独坐于此耶？”芸曰：“俟有可观者再往耳。”</p>\n<p>王闻言先出，请吾母点《刺梁》《后索》等剧，劝芸出观，始称快。</p>\n",
            "tags": [
                "抄书",
                "练字"
            ]
        },
        {
            "id": "https://utgnim.github.io/%E6%B5%AE%E7%94%9F%E5%85%AD%E8%AE%B0-%E5%8D%B7%E4%B8%80-%E9%97%BA%E6%88%BF%E8%AE%B0%E4%B9%90-%E6%8B%BE%E5%9B%9B/",
            "url": "https://utgnim.github.io/%E6%B5%AE%E7%94%9F%E5%85%AD%E8%AE%B0-%E5%8D%B7%E4%B8%80-%E9%97%BA%E6%88%BF%E8%AE%B0%E4%B9%90-%E6%8B%BE%E5%9B%9B/",
            "title": "浮生六记 - 卷一 闺房记乐 拾四",
            "date_published": "2025-07-19T15:54:08.000Z",
            "content_html": "<p>中秋日，余病初愈。以芸半年新妇，未尝一至间壁之沧浪亭，先令老仆约守者，勿放闲人。于将晚时，偕芸及余幼妹，一妪一婢扶焉，老仆前导，过石桥，进门折东，曲径而入。叠石成山，林木葱翠，亭在土山之巅。循级至亭心，周望极目可数里。炊烟四起，晚霞灿然。隔岸名“近山林”，为大宪行台宴集之地，时正谊书院犹未启也。</p>\n<p>携一毯设亭中，席地环坐，守者烹茶以进。少焉，一轮明月已上林梢，渐觉风生袖底，月到波心，俗虑尘怀，爽然顿释。芸曰：“今日之游乐矣！若驾一叶扁舟，往来亭下，不更快哉！”</p>\n<p>吴俗，妇女是晚不拘大家小户皆出，结队而游，名曰“走月亮”。沧浪亭幽雅清旷，反无一人至者。</p>\n",
            "tags": [
                "抄书",
                "练字"
            ]
        },
        {
            "id": "https://utgnim.github.io/%E6%B5%AE%E7%94%9F%E5%85%AD%E8%AE%B0-%E5%8D%B7%E4%B8%80-%E9%97%BA%E6%88%BF%E8%AE%B0%E4%B9%90-%E6%8B%BE%E4%B8%89/",
            "url": "https://utgnim.github.io/%E6%B5%AE%E7%94%9F%E5%85%AD%E8%AE%B0-%E5%8D%B7%E4%B8%80-%E9%97%BA%E6%88%BF%E8%AE%B0%E4%B9%90-%E6%8B%BE%E4%B8%89/",
            "title": "浮生六记 - 卷一 闺房记乐 拾三",
            "date_published": "2025-07-18T13:48:17.000Z",
            "content_html": "<p>七月望，俗谓之鬼节。芸备小酌，拟邀月畅饮。</p>\n<p>夜忽阴云如晦，芸愀然曰：“妾能与君白头偕老，月轮当出。”余亦索然。但见隔岸萤光，明灭万点，梳织于柳堤蓼渚间。</p>\n<p>余与芸联句以遣闷怀，而两韵之后，逾联逾纵，想入非夷，随口乱道。芸已漱涎涕泪，笑倒余怀，不能成声矣。觉其鬓边茉莉浓香扑鼻，因拍其背，以他词解之曰：“想古人以茉莉形色如珠，故供助妆压鬓，不知此花必沾油头粉面之气，其香更可爱，所以供佛手，当退三舍矣。”</p>\n<p>芸乃止笑曰：“佛手乃香中君子，只在有意无意间；茉莉是香中小人，故须借人之势，其香也如胁肩谄笑。”余曰：“卿何远君子而近小人？”芸曰：“我笑君子爱小人耳。”</p>\n<p>正话间，漏已三滴，渐见风扫云开，一轮涌出，乃大喜，倚窗对酌。酒未三杯，忽闻桥下哄然一声，如有人堕。就窗细瞩，波明如镜，不见一物，惟闻河滩有只鸭急奔声。余知沧浪亭畔素有溺鬼，恐芸胆怯，未敢即言。</p>\n<p>芸曰：“噫！此声也，胡为乎来哉？”</p>\n<p>不禁毛骨皆栗。急闭窗，携酒归房。一灯如豆，罗帐低垂，弓影杯蛇，惊神未定。剔灯入帐，芸已寒热大作。余亦继之，困顿两旬。</p>\n<p>真所谓乐极灾生，亦是白头不终之兆。</p>\n",
            "tags": [
                "抄书",
                "练字"
            ]
        },
        {
            "id": "https://utgnim.github.io/%E6%B5%AE%E7%94%9F%E5%85%AD%E8%AE%B0-%E5%8D%B7%E4%B8%80-%E9%97%BA%E6%88%BF%E8%AE%B0%E4%B9%90-%E6%8B%BE%E4%BA%8C/",
            "url": "https://utgnim.github.io/%E6%B5%AE%E7%94%9F%E5%85%AD%E8%AE%B0-%E5%8D%B7%E4%B8%80-%E9%97%BA%E6%88%BF%E8%AE%B0%E4%B9%90-%E6%8B%BE%E4%BA%8C/",
            "title": "浮生六记 - 卷一 闺房记乐 拾二",
            "date_published": "2025-07-18T13:38:39.000Z",
            "content_html": "<p>是年七夕，芸设香烛瓜果，同拜天孙于“我取轩”。</p>\n<p>余镌“愿生生世世为夫妇”图章二方，余执朱文，芸执白文，以为往来书信之用。是夜，月色颇佳。俯视河中，波光如练。轻罗小扇，并坐水窗，仰见飞云过天，变态万状。</p>\n<p>芸曰：“宇宙之大，同此一月，不知今日世间，亦有如两人之情兴否？”</p>\n<p>余曰：“纳凉玩月，到处有之。若品论云霞，或求之幽闺绣闼，慧心默证者，固亦不少。若夫妇同观，所品论者，恐不在此云霞耳。”</p>\n<p>未几，烛烬月沉，撤果归卧。</p>\n",
            "tags": [
                "抄书",
                "练字"
            ]
        }
    ]
}